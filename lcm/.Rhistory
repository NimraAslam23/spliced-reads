ggplot(smaller, aes(x = carat, y = price)) +
geom_boxplot(aes(group = cut_number(carat, 20)))
library(tidyverse)
library(ggrepel)
library(ggrepel)
install.packages("ggrepel")
library(ggrepel)
install.packages("ggrepel")
library(ggrepel)
install.packages("patchwork")
library(patchwork)
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class)) +
geom_smooth(se = FALSE) +
labs(
title = "Fuel efficiency generally decreases with engine size",
subtitle = "Two seaters (sports cars) are an exception because of their light weight",
caption = "Data from fueleconomy.gov"
)
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class)) +
geom_smooth(se = FALSE) +
labs(
title = "Fuel efficiency generally decreases with engine size",
subtitle = "Two seaters (sports cars) are an exception because of their light weight",
caption = "Data from fueleconomy.gov"
x = "Engine displacement (L)",
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class)) +
geom_smooth(se = FALSE) +
labs(
title = "Fuel efficiency generally decreases with engine size",
subtitle = "Two seaters (sports cars) are an exception because of their light weight",
caption = "Data from fueleconomy.gov",
x = "Engine displacement (L)",
y = "Highway fuel economy (mpg)",
color = "Car type"
)
?plotmath
label_info <- mpg |>
group_by(drv) |>
arrange(desc(displ)) |>
slice_head(n = 1) |>
mutate(
drive_type = case_when(
drv == "f" ~ "front-wheel drive",
drv == "r" ~ "rear-wheel drive",
drv == "4" ~ "4-wheel drive"
)
) |>
select(displ, hwy, drv, drive_type)
label_info
ggpplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point()
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point()
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3)
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth()
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE)
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE) +
geom_text(
data = label_info,
aes(x = displ, y = hwy, label = drive_type)
)
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE) +
geom_text(
data = label_info,
aes(x = displ, y = hwy, label = drive_type),
fontface = "bold", size = 5
)
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE) +
geom_text(
data = label_info,
aes(x = displ, y = hwy, label = drive_type),
fontface = "bold", size = 5, hjust = "right"
)
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE) +
geom_text(
data = label_info,
aes(x = displ, y = hwy, label = drive_type),
fontface = "bold", size = 5, hjust = "left"
)
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE) +
geom_text(
data = label_info,
aes(x = displ, y = hwy, label = drive_type),
fontface = "bold", size = 5, hjust = "right"
)
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE) +
geom_text(
data = label_info,
aes(x = displ, y = hwy, label = drive_type),
fontface = "bold", size = 5, hjust = "right", vjust = "bottom"
)
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE) +
geom_text(
data = label_info,
aes(x = displ, y = hwy, label = drive_type),
fontface = "bold", size = 5, hjust = "right", vjust = "bottom"
) +
theme(legend.position = "none")
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE) +
geom_label(
data = label_info,
aes(x = displ, y = hwy, label = drive_type),
fontface = "bold", size = 5, hjust = "right", vjust = "bottom"
) +
theme(legend.position = "none")
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE) +
geom_label(
data = label_info,
aes(x = displ, y = hwy, label = drive_type),
fontface = "bold", size = 5, hjust = "right", vjust = "bottom", nudge_y = 2,
) +
theme(legend.position = "none")
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE) +
geom_label(
data = label_info,
aes(x = displ, y = hwy, label = drive_type),
fontface = "bold", size = 5, hjust = "right", nudge_y = 2,
) +
theme(legend.position = "none")
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE) +
geom_label(
data = label_info,
aes(x = displ, y = hwy, label = drive_type),
fontface = "bold", size = 5, hjust = "right",alpha = 0.5, nudge_y = 2,
) +
theme(legend.position = "none")
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE) +
geom_label(
data = label_info,
aes(x = displ, y = hwy, label = drive_type),
fontface = "bold", size = 5, hjust = "right", alpha = 0.5, nudge_y = 2,
) +
theme(legend.position = "none")
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE) +
geom_label+repel(
data = label_info,
aes(x = displ, y = hwy, label = drive_type),
fontface = "bold", size = 5, nudge_y = 2,
) +
theme(legend.position = "none")
ggplot(mpg, aes(x = displ, y = hwy, color = drv)) +
geom_point(alpha = 0.3) +
geom_smooth(se = FALSE) +
geom_label_repel(
data = label_info,
aes(x = displ, y = hwy, label = drive_type),
fontface = "bold", size = 5, nudge_y = 2,
) +
theme(legend.position = "none")
potential_outliers <- mpg |>
filter(hwy > 40 | (hwy > 20 & displ > 5))
potential_outliers
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point()
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point() +
geom_text_repel(data = potential_outliers, aes(label = model))
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point() +
geom_text_repel(data = potential_outliers, aes(label = model)) +
geom_point(data = potential_outliers, color = "red")
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point() +
geom_text_repel(data = potential_outliers, aes(label = model)) +
geom_point(data = potential_outliers, color = "red") +
geom_point(data = potential_outliers, color = "red", size = 3, shape = "circle open")
?annotate
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point()
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class))
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class)) +
scale_x_continuous() +
scale_y_continuous() +
scale_color_discrete()
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point()
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point() +
scale_y_continuous(breaks = 2)
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point() +
scale_y_continuous(breaks = seq(15, 40, by = 5))
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point()
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class))
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class)) +
geom_smooth(se = FALSE)
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class)) +
geom_smooth(se = FALSE) +
theme(legend.position = "bottom")
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class)) +
geom_smooth(se = FALSE) +
theme(legend.position = "bottom") +
guides(color = guide_legend)
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class)) +
geom_smooth(se = FALSE) +
theme(legend.position = "bottom") +
guides(color = guide_legend(nrow = 1))
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class)) +
geom_smooth(se = FALSE) +
theme(legend.position = "bottom") +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 4)))
getwd()
ptdp_orig <- read.csv("ptdp_mn_death.csv")
View(ptdp_orig)
View(spliced_reads_orig)
View(group_column)
View(mean_per_junction)
View(sig_reads_groups)
spliced_reads |>
left_join(ptdp_mn_death)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(dplyr)
spliced_reads |>
left_join(ptdp_mn_death)
spliced_reads |>
left_join(ptdp_mn_death |>
select(sample, pTDP.43, MN_death, pTDP_category))
ptdp_orig <- read.csv("ptdp_mn_death.csv")
spliced_reads |>
left_join(ptdp_mn_death |>
select(sample, pTDP.43, MN_death, pTDP_category))
spliced_reads |>
left_join(ptdp_orig)
View(spliced_reads)
View(mean_n_datasets_found)
View(mean_n_datasets_found)
View(mean_per_junction)
View(mean_per_junction_2)
View(mean_per_junction_sig)
View(mean_per_junction_sig1)
View(ptdp_orig)
View(sig_reads_groups)
View(ptdp_orig)
View(sig_reads_groups)
View(significant_junctions)
View(spliced_reads)
source("~/Documents/GitHub/spliced-reads/lcm/spliced_read_from_lcm.R")
spliced_reads |>
str_remove(sample_name, "[.SJ.out]")
spliced_reads |>
str_remove(sample_name, ".SJ.out")
spliced_reads |>
str_remove_all(sample_name, ".SJ.out")
?str_remove
colours <- str_c("\\b", colors(), "\\b", collapse="|")
colours
col2hex <- function(col) {
rgb <- col2rgb(col)
rgb(rgb["red", ], rgb["green", ], rgb["blue", ], max = 255)
}
x <- c(
"Roses are red, violets are blue",
"My favourite colour is green"
)
str_replace_all(x, colours, col2hex)
spliced_reads |>
gsub('[.SJ.out]',sample_name)
spliced_reads |>
gsub('[.SJ.out]', sample_name)
spliced_reads |>
gsub('[.SJ.out]', spliced_reads$sample_name)
spliced_reads |>
gsub(".SJ.out", sample_name)
spliced_reads |>
gsub(".SJ.out", "",sample_name)
spliced_reads |>
gsub(".SJ.out", "",as.character(sample_name))
gsub(".SJ.out", "", as.character(spliced_reads$sample_name))
View(spliced_reads)
spliced_reads <- gsub(".SJ.out", "", as.character(spliced_reads$sample_name))
spliced_reads_orig <- read.csv("spliced_read_from_lcm.csv")
spliced_reads <- spliced_reads_orig
spliced_reads$sample_name <- gsub(".SJ.out", "", as.character(spliced_reads$sample_name))
View(spliced_reads)
spliced_reads |>
left_join(ptdp_orig)
spliced_reads |>
left_join(ptdp_orig, join_by(sample_name))
library(tidyverse)
library(ggplot2)
library(tidyr)
library(dplyr)
spliced_reads |>
left_join(ptdp_orig, join_by(sample_name))
?join_by
??join_by
spliced_reads |>
left_join(ptdp_orig, sample_name)
spliced_reads |>
left_join(ptdp_orig, by == sample_name)
spliced_reads |>
left_join(ptdp_orig, by = sample_name)
spliced_reads |>
left_join(ptdp_orig, by = "sample_name")
spliced_reads |>
left_join(ptdp_orig,
by='sample_name' = 'sample')
ptdp_orig |>
rename("sample" = "sample_name")
ptdp_orig |>
rename("sample_name" = "sample")
ptdp_orig <- ptdp_orig |>
rename("sample_name" = "sample")
spliced_reads |>
left_join(ptdp_orig, by = "sample_name")
spliced_reads_pdtp <- spliced_reads |>
left_join(ptdp_orig, by = "sample_name")
View(spliced_reads_pdtp)
spliced_reads_pdtp |>
select(sample_name, n_spliced_reads, junction_name, pTDP.43, MN_death, pTDP_category)
spliced_reads_pdtp_select <- spliced_reads_pdtp |>
select(sample_name, n_spliced_reads, junction_name, pTDP.43, MN_death, pTDP_category)
View(spliced_reads_pdtp_select)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point()
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death, na.rm = TRUE)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death), na.rm = TRUE) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death), na.rm = TRUE) +
geom_point(na.rm = TRUE) +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death), na.rm = TRUE) +
geom_point(na.rm = TRUE) +
facet_wrap(~pTDP_category, na.RM = TRUE)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(na.omit(spliced_reads_pdtp_select$MN_death), aes(x = n_spliced_reads, y = MN_death)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
mutate(mean_n_spliced_reads = mean(n_spliced_reads)) |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
facet_wrap(~pTDP_category)
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
labs(title = "STMN2 expression is higher in low MN_death") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
labs(
title = "STMN2 expression is higher in low MN_death",
x = "MN_death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43",
x = "MN_death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "MN_death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "MN_death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
