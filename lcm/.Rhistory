mutation_clinical_data |>
group_by(gene) |>
mutate(proportion = (n() / sum(n))) |> View()
mutation_clinical_data |>
count(gene) |>
group_by(gene) |>
mutate(proportion = n / sum(n)) |> View()
mutation_clinical_data |>
count(gene, name = "n") |>
group_by(gene) |>
mutate(proportion = n / sum(n)) |>
View()
mutation_clinical_data |>
group_by(gene) |>
summarize(n = n()) |>
mutate(proportion = n / sum(n)) |>
View()
mutation_clinical_data |>
group_by(gene) |>
summarize(n = n()) |>
mutate(proportion = n / sum(n)) |>
mutate(percent = proportion*100) |>
View()
mutation_clinical_data |> sum(percent)
sum(mutation_clinical_data$percent)
mutation_clinical_data |> summarise(total_proportion = sum(proportion))
mutation_clinical_data |>
group_by(gene) |>
summarize(n = n()) |>
mutate(proportion = n / sum(n)) |>
mutate(percent = proportion*100) |> summarise(total_proportion = sum(proportion))
mutation_clinical_data |>
group_by(gene) |>
summarize(n = n()) |>
mutate(proportion = n / sum(n)) |>
mutate(percent = proportion*100) |> summarise(total_percent = sum(percent))
mutation_clinical_data <- mutation_clinical_data |>
group_by(gene) |>
summarize(n = n()) |>
mutate(proportion = n / sum(n)) |>
mutate(percent = proportion*100)
mutation_clinical_data <- read.table("mutation_clinical_data.txt", sep=",")
mutation_clinical_data <- mutation_clinical_data |>
group_by(gene) |>
summarize(n = n()) |>
mutate(proportion = n / sum(n))
mutation_clinical_data |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
group_by(gene) |>
summarize(n = n()) |>
mutate(common_cases_proportion = n / sum(n)) |> View()
mutation_clinical_data |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
group_by(gene) |>
summarize(n = n()) |>
mutate(common_cases_proportion = n / sum(n)) |>
View()
mutation_clinical_data |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
group_by(gene) |>
summarize(n = n()) |>
mutate(common_cases_proportion = n / sum(n))
View(all_common_cases)
View(mutation_clinical_data)
mutation_clinical_data <- mutation_clinical_data |>
group_by(gene) |>
summarize(n = n()) |>
mutate(proportion = n / sum(n)) |>
ungroup()
mutation_clinical_data <- read.table("mutation_clinical_data.txt", sep=",")
mutation_clinical_data <- mutation_clinical_data |>
group_by(gene) |>
mutate(n = n(),
proportion = n / sum(n))
mutation_proportions <- mutation_clinical_data |>
group_by(gene) |>
summarise(n = n()) |>
mutate(proportion = n / sum(n))
View(mutation_proportions)
common_cases_mutation_proportions <- mutation_clinical_data |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
group_by(gene) |>
summarise(n = n()) |>
mutate(common_cases_proportion = n / sum(n))
View(common_cases_mutation_proportions)
gene_mutation_proportions <- mutation_clinical_data |>
group_by(gene) |>
summarise(n = n()) |>
mutate(proportion = n / sum(n))
View(gene_mutation_proportions)
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
View()
mutation_clinical_data <- read.table("mutation_clinical_data.txt", sep=",")
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
View()
mutation_clinical_data <- read.table("mutation_clinical_data.txt", sep=",")
gene_mutation_proportions <- mutation_clinical_data |>
group_by(gene) |>
summarise(gene_mutation_count = n()) |>
mutate(proportion = n / sum(n))
gene_mutation_proportions <- mutation_clinical_data |>
group_by(gene) |>
summarise(gene_mutation_count = n()) |>
mutate(proportion = n / sum(gene_mutation_count))
gene_mutation_proportions <- mutation_clinical_data |>
group_by(gene) |>
summarise(gene_mutation_count = n()) |>
mutate(proportion = gene_mutation_count / sum(gene_mutation_count))
common_cases_mutation_proportions <- mutation_clinical_data |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
group_by(gene) |>
summarise(common_cases_mutation_count = n()) |>
mutate(common_cases_proportion = common_cases_mutation_count / sum(common_cases_mutation_count))
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
View()
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
pivot_longer(cols = c(proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
View()
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
pivot_longer(cols = c(proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
ggplot(aes(x = general_vs_common_cases,
y = proportion)) +
geom_col(position = "dodge")
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
pivot_longer(cols = c(proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
ggplot(aes(x = gene,
y = proportion,
fill = general_vs_common_cases)) +
geom_col(position = "dodge")
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
pivot_longer(cols = c(proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
ggplot(aes(x = gene,
y = proportion,
fill = general_vs_common_cases)) +
geom_col(position = "dodge") +
scale_y_continuous(labels = scales::percent_format())
View(cosmic_cancer_genes)
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
ggplot(aes(x = gene,
y = proportion,
fill = general_vs_common_cases)) +
geom_col(position = "dodge") +
scale_y_continuous(labels = scales::percent_format())
gene_mutation_proportions <- mutation_clinical_data |>
group_by(gene) |>
summarise(gene_mutation_count = n()) |>
mutate(general = gene_mutation_count / sum(gene_mutation_count))
gene_mutation_proportions <- mutation_clinical_data |>
group_by(gene) |>
summarise(gene_mutation_count = n()) |>
mutate(general_proportion = gene_mutation_count / sum(gene_mutation_count))
common_cases_mutation_proportions <- mutation_clinical_data |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
group_by(gene) |>
summarise(common_cases_mutation_count = n()) |>
mutate(common_cases_proportion = common_cases_mutation_count / sum(common_cases_mutation_count))
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common_cases",
TRUE ~ general_vs_common_cases
)) |>
View(0)
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common_cases",
TRUE ~ general_vs_common_cases
)) |>
View()
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common_cases",
TRUE ~ general_vs_common_cases
)) |>
View()
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common_cases",
TRUE ~ general_vs_common_cases
)) |> View()
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |> View()
mutation_clinical_data <- read.table("mutation_clinical_data.txt", sep=",")
gene_mutation_proportions <- mutation_clinical_data |>
group_by(gene) |>
summarise(gene_mutation_count = n()) |>
mutate(general_proportion = gene_mutation_count / sum(gene_mutation_count))
common_cases_mutation_proportions <- mutation_clinical_data |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
group_by(gene) |>
summarise(common_cases_mutation_count = n()) |>
mutate(common_cases_proportion = common_cases_mutation_count / sum(common_cases_mutation_count))
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |> View()
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "general_proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common_cases",
TRUE ~ general_vs_common_cases
)) |> View()
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
pivot_longer(cols = c(gene_mutation_count, common_cases_mutation_count),
names_to = "general_vs_common_cases",
values_to = "gene_mutation_count") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "general_proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common_cases",
TRUE ~ general_vs_common_cases
)) |> View()
mutation_clinical_data <- read.table("mutation_clinical_data.txt", sep=",")
gene_mutation_proportions <- mutation_clinical_data |>
group_by(gene) |>
summarise(gene_mutation_count = n()) |>
mutate(general_proportion = gene_mutation_count / sum(gene_mutation_count))
common_cases_mutation_proportions <- mutation_clinical_data |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
group_by(gene) |>
summarise(common_cases_mutation_count = n()) |>
mutate(common_cases_proportion = common_cases_mutation_count / sum(common_cases_mutation_count))
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
pivot_longer(cols = c(gene_mutation_count, common_cases_mutation_count),
names_to = "general_vs_common_cases",
values_to = "gene_mutation_count") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "general_proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common_cases",
TRUE ~ general_vs_common_cases
)) |> View()
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
pivot_longer(cols = c(gene_mutation_count, common_cases_mutation_count),
names_to = "gene_or_common",
values_to = "gene_mutation_count") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "general_proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common_cases",
TRUE ~ general_vs_common_cases
)) |> View()
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
pivot_longer(cols = c(gene_mutation_count, common_cases_mutation_count),
names_to = "gene_or_common",
values_to = "gene_mutation_count") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "general_proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common_cases",
TRUE ~ general_vs_common_cases
)) |>
mutate(gene_or_common = case_when(
gene_or_common == "gene_mutation_count" ~ "general",
gene_or_common == "common_cases_mutation_count" ~ "common_cases",
TRUE ~ gene_or_common
))
mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
pivot_longer(cols = c(gene_mutation_count, common_cases_mutation_count),
names_to = "gene_or_common",
values_to = "gene_mutation_count") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "general_proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common_cases",
TRUE ~ general_vs_common_cases
)) |>
mutate(gene_or_common = case_when(
gene_or_common == "gene_mutation_count" ~ "general",
gene_or_common == "common_cases_mutation_count" ~ "common_cases",
TRUE ~ gene_or_common
)) |> View()
View(tcga_cryptics_metatable)
mutation_clinical_data |>
left_join(tcga_cryptics_metatable, by="case_submitter_id") |>
filter(gene_name == "STMN2") |> View()
View()
View()
select(-ends_with("_y") |> View()
View()
filter(gene_name == "STMN2") |>  select(-ends_with(".y") |> View()
mutation_clinical_data |>
mutation_clinical_data |>
left_join(tcga_cryptics_metatable, by="case_submitter_id") |>
filter(gene_name == "STMN2") |>
select(-ends_with(".y")) |> View()
mutation_clinical_data |>
left_join(tcga_cryptics_metatable, by="case_submitter_id") |>
filter(gene_name == "STMN2") |>
select(-ends_with(".y")) |> janitor::clean_names() |> View()
mutation_clinical_data |>
left_join(tcga_cryptics_metatable, by="case_submitter_id") |>
filter(gene_name == "STMN2") |>
select(-ends_with(".y")) |> janitor::clean_names() |>
rename_with(~ gsub("_x$", "", .), contains("_x")) |> View()
mutation_clinical_data |>
left_join(tcga_cryptics_metatable, by="case_submitter_id") |>
select(-ends_with(".y")) |> janitor::clean_names() |>
rename_with(~ gsub("_x$", "", .), contains("_x")) |>
filter(gene_name == "STMN2") |> View()
mutation_clinical_data |>
left_join(tcga_cryptics_metatable, by="case_submitter_id") |>
select(-ends_with(".y")) |> janitor::clean_names() |>
rename_with(~ gsub("_x$", "", .), contains("_x")) |>
filter(gene_name == "STMN2") |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
pivot_longer(cols = c(gene_mutation_count, common_cases_mutation_count),
names_to = "gene_or_common",
values_to = "gene_mutation_count") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "general_proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common_cases",
TRUE ~ general_vs_common_cases
)) |> View()
mutation_clinical_data |>
left_join(tcga_cryptics_metatable, by="case_submitter_id") |>
select(-ends_with(".y")) |> janitor::clean_names() |>
rename_with(~ gsub("_x$", "", .), contains("_x")) |>
filter(gene_name == "STMN2") |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
pivot_longer(cols = c(gene_mutation_count, common_cases_mutation_count),
names_to = "gene_or_common",
values_to = "gene_mutation_count") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "general_proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common_cases",
TRUE ~ general_vs_common_cases
)) |>
ggplot(aes(x = gene,
y = proportion,
fill = general_vs_common_cases)) +
geom_col(position = "dodge") +
scale_y_continuous(labels = scales::percent_format())
mutation_clinical_data |>
left_join(tcga_cryptics_metatable, by="case_submitter_id") |>
select(-ends_with(".y")) |> janitor::clean_names() |>
rename_with(~ gsub("_x$", "", .), contains("_x")) |>
filter(gene_name == "STMN2") |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
pivot_longer(cols = c(gene_mutation_count, common_cases_mutation_count),
names_to = "gene_or_common",
values_to = "gene_mutation_count") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "general_proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common_cases",
TRUE ~ general_vs_common_cases
)) |>
ggplot(aes(x = gene,
y = proportion,
fill = general_vs_common_cases)) +
geom_col(position = "dodge") +
scale_y_continuous(labels = scales::percent_format()) +
theme(legend.position = "bottom")
mutation_clinical_data |>
left_join(tcga_cryptics_metatable, by="case_submitter_id") |>
select(-ends_with(".y")) |> janitor::clean_names() |>
rename_with(~ gsub("_x$", "", .), contains("_x")) |>
filter(gene_name == "STMN2") |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
pivot_longer(cols = c(gene_mutation_count, common_cases_mutation_count),
names_to = "gene_or_common",
values_to = "gene_mutation_count") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "general_proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common_cases",
TRUE ~ general_vs_common_cases
)) |>
ggplot(aes(x = gene,
y = proportion,
fill = general_vs_common_cases)) +
geom_col(position = "dodge") +
coord_flip() +
scale_y_continuous(labels = scales::percent_format()) +
theme(legend.position = "bottom")
