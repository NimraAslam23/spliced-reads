geom_point(aes(color = class)) +
geom_smooth(se = FALSE)
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class)) +
geom_smooth(se = FALSE) +
theme(legend.position = "bottom")
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class)) +
geom_smooth(se = FALSE) +
theme(legend.position = "bottom") +
guides(color = guide_legend)
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class)) +
geom_smooth(se = FALSE) +
theme(legend.position = "bottom") +
guides(color = guide_legend(nrow = 1))
ggplot(mpg, aes(x = displ, y = hwy)) +
geom_point(aes(color = class)) +
geom_smooth(se = FALSE) +
theme(legend.position = "bottom") +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 4)))
getwd()
ptdp_orig <- read.csv("ptdp_mn_death.csv")
View(ptdp_orig)
View(spliced_reads_orig)
View(group_column)
View(mean_per_junction)
View(sig_reads_groups)
spliced_reads |>
left_join(ptdp_mn_death)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(dplyr)
spliced_reads |>
left_join(ptdp_mn_death)
spliced_reads |>
left_join(ptdp_mn_death |>
select(sample, pTDP.43, MN_death, pTDP_category))
ptdp_orig <- read.csv("ptdp_mn_death.csv")
spliced_reads |>
left_join(ptdp_mn_death |>
select(sample, pTDP.43, MN_death, pTDP_category))
spliced_reads |>
left_join(ptdp_orig)
View(spliced_reads)
View(mean_n_datasets_found)
View(mean_n_datasets_found)
View(mean_per_junction)
View(mean_per_junction_2)
View(mean_per_junction_sig)
View(mean_per_junction_sig1)
View(ptdp_orig)
View(sig_reads_groups)
View(ptdp_orig)
View(sig_reads_groups)
View(significant_junctions)
View(spliced_reads)
source("~/Documents/GitHub/spliced-reads/lcm/spliced_read_from_lcm.R")
spliced_reads |>
str_remove(sample_name, "[.SJ.out]")
spliced_reads |>
str_remove(sample_name, ".SJ.out")
spliced_reads |>
str_remove_all(sample_name, ".SJ.out")
?str_remove
colours <- str_c("\\b", colors(), "\\b", collapse="|")
colours
col2hex <- function(col) {
rgb <- col2rgb(col)
rgb(rgb["red", ], rgb["green", ], rgb["blue", ], max = 255)
}
x <- c(
"Roses are red, violets are blue",
"My favourite colour is green"
)
str_replace_all(x, colours, col2hex)
spliced_reads |>
gsub('[.SJ.out]',sample_name)
spliced_reads |>
gsub('[.SJ.out]', sample_name)
spliced_reads |>
gsub('[.SJ.out]', spliced_reads$sample_name)
spliced_reads |>
gsub(".SJ.out", sample_name)
spliced_reads |>
gsub(".SJ.out", "",sample_name)
spliced_reads |>
gsub(".SJ.out", "",as.character(sample_name))
gsub(".SJ.out", "", as.character(spliced_reads$sample_name))
View(spliced_reads)
spliced_reads <- gsub(".SJ.out", "", as.character(spliced_reads$sample_name))
spliced_reads_orig <- read.csv("spliced_read_from_lcm.csv")
spliced_reads <- spliced_reads_orig
spliced_reads$sample_name <- gsub(".SJ.out", "", as.character(spliced_reads$sample_name))
View(spliced_reads)
spliced_reads |>
left_join(ptdp_orig)
spliced_reads |>
left_join(ptdp_orig, join_by(sample_name))
library(tidyverse)
library(ggplot2)
library(tidyr)
library(dplyr)
spliced_reads |>
left_join(ptdp_orig, join_by(sample_name))
?join_by
??join_by
spliced_reads |>
left_join(ptdp_orig, sample_name)
spliced_reads |>
left_join(ptdp_orig, by == sample_name)
spliced_reads |>
left_join(ptdp_orig, by = sample_name)
spliced_reads |>
left_join(ptdp_orig, by = "sample_name")
spliced_reads |>
left_join(ptdp_orig,
by='sample_name' = 'sample')
ptdp_orig |>
rename("sample" = "sample_name")
ptdp_orig |>
rename("sample_name" = "sample")
ptdp_orig <- ptdp_orig |>
rename("sample_name" = "sample")
spliced_reads |>
left_join(ptdp_orig, by = "sample_name")
spliced_reads_pdtp <- spliced_reads |>
left_join(ptdp_orig, by = "sample_name")
View(spliced_reads_pdtp)
spliced_reads_pdtp |>
select(sample_name, n_spliced_reads, junction_name, pTDP.43, MN_death, pTDP_category)
spliced_reads_pdtp_select <- spliced_reads_pdtp |>
select(sample_name, n_spliced_reads, junction_name, pTDP.43, MN_death, pTDP_category)
View(spliced_reads_pdtp_select)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point()
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death, na.rm = TRUE)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death), na.rm = TRUE) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death), na.rm = TRUE) +
geom_point(na.rm = TRUE) +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death), na.rm = TRUE) +
geom_point(na.rm = TRUE) +
facet_wrap(~pTDP_category, na.RM = TRUE)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(na.omit(spliced_reads_pdtp_select$MN_death), aes(x = n_spliced_reads, y = MN_death)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
mutate(mean_n_spliced_reads = mean(n_spliced_reads)) |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
facet_wrap(~pTDP_category)
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
labs(title = "STMN2 expression is higher in low MN_death") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
labs(
title = "STMN2 expression is higher in low MN_death",
x = "MN_death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43",
x = "MN_death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "MN_death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "MN_death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(dplyr)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
hist(MNN_death)
hist(MN_death)
hist(spliced_reads_pdtp_select$MN_death)
spliced_reads_pdtp_select |>
ggplot(aes(x = MN_death)) +
geom_bar()
spliced_reads_pdtp_select |>
ggplot(aes(x = n_spliced_reads)) +
geom_bar()
spliced_reads_pdtp_select |>
hist(n_spliced_reads)
spliced_reads_pdtp_select |>
hist(x = n_spliced_reads)
hist(spliced_reads_pdtp_select$n_spliced_reads)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death (%)", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = n_spliced_reads)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43",
x = "Motor neuron death (%)",
y = "Number of STMN2 spliced reads")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = n_spliced_reads)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43",
x = "pTDP-43 accumulation",
y = "Number of STMN2 spliced reads")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43",
x = "pTDP-43 accumulation",
y = "Number of STMN2 spliced reads")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43",
x = "pTDP-43 accumulation",
y = "Motor neuron death (%)")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "pTDP-43 levels do not affect levels of morphologically intact motor neurons",
x = "pTDP-43 accumulation",
y = "Motor neuron death (%)")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "pTDP-43 levels do not affect levels of viable motor neurons",
x = "pTDP-43 accumulation",
y = "Motor neuron death (%)")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "pTDP-43 levels do not affect viability of motor neurons",
x = "pTDP-43 accumulation",
y = "Motor neuron death (%)")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "pTDP-43 levels do not affect viability of motor neurons",
x = "pTDP-43 accumulation",
y = "Motor neuron death (%)")
stmn2_all_junctions_orig <- read.tsv("stmn2_all_junctions.bed")
stmn2_all_junctions_orig <- read_tsv("stmn2_all_junctions.bed")
View(stmn2_all_junctions_orig)
stmn2_all_junctions_orig <- read_tsv("stmn2_all_junctions.bed", col_names = FALSE)
View(stmn2_all_junctions_orig)
View(spliced_reads_pdtp_select)
View(spliced_reads_pdtp)
View(spliced_reads_pdtp_select)
stmn2_all_junctions_orig |>
col_names = c("chrosome", "start", "end", "sample_name", "n_spliced_reads", "strand")
stmn2_all_junctions_orig <- read_tsv("stmn2_all_junctions.bed", col_names = FALSE,
col_names = c("chrosome", "start", "end", "sample_name",
"n_spliced_reads", "strand"))
stmn2_all_junctions_orig <- read_tsv("stmn2_all_junctions.bed",
col_names = c("chrosome", "start", "end", "sample_name",
"n_spliced_reads", "strand"))
stmn2_all_junctions_orig <- read_tsv("stmn2_all_junctions.bed")
stmn2_all_junctions_orig <- read_tsv("stmn2_all_junctions.bed",
col_names = c("chrosome", "start", "end", "sample_name",
"n_spliced_reads", "strand"))
stmn2_all_junctions <- stmn2_all_junctions_orig
stmn2_all_junctions$sample_name <- gsub(".SJ.out", "", as.character(stmn2_all_junctions$sample_name))
View(stmn2_all_junctions_orig)
View(stmn2_all_junctions)
stmn2_all_junctions <- unique(stmn2_all_junctions_orig)
View(stmn2_all_junctions)
View(stmn2_all_junctions_orig)
stmn2_all_junctions$sample_name <- gsub(".SJ.out", "", as.character(stmn2_all_junctions$sample_name))
