mutate(proportion = n/sum(n)) |>
filter(n >= 10) |>
ggplot(aes(x = reorder(hugo_symbol, n), y = n,
fill = cancer_driver_gene)) +
geom_col() +
coord_flip() +
labs(x = "Mutated Gene",
y = "Number of Mutations",
fill = "Cancer Driver Gene") +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "dodgerblue", "non_driver" = "tomato"))
# fraction of mutations that are in cancer drivers vs non-drivers in each cancer type with cryptic STMN2
STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
group_by(cancer_abbrev, cancer_driver_gene) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = cancer_abbrev, y = proportion,
fill = cancer_driver_gene,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
labs(x = "Cancer Type",
y = "Percentage of Mutations",
fill = "Cancer Driver Gene",
title = "Mutations in Cancer Patients with Cryptic STMN2 Events") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 4) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "dodgerblue", "non_driver" = "tomato"))
# fraction of mutations that are in cancer drivers vs non-drivers in each cancer type with cryptic STMN2
STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
group_by(cancer_abbrev, cancer_driver_gene) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = cancer_abbrev, y = proportion,
fill = cancer_driver_gene,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
labs(x = "Cancer Type",
y = "Percentage of Mutations",
fill = "Cancer Driver Gene",
title = "Mutations in Cancer Patients with Cryptic STMN2 Events") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 4) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
group_by(hugo_symbol) |>
mutate(n = n()) |>
mutate(proportion = n/sum(n)) |>
filter(n >= 10) |>
ggplot(aes(x = reorder(hugo_symbol, n), y = n,
fill = cancer_driver_gene)) +
geom_col() +
coord_flip() +
labs(x = "Mutated Gene",
y = "Number of Mutations",
fill = "Cancer Driver Gene") +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
# gene with the highest number of mutations in cryptic STMN2 cases
STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
group_by(hugo_symbol) |>
mutate(n = n()) |>
mutate(proportion = n/sum(n)) |>
filter(n >= 10) |>
ggplot(aes(x = reorder(hugo_symbol, n), y = n,
fill = cancer_driver_gene,
fill = known_or_novel_variant)) +
geom_col() +
coord_flip() +
labs(x = "Mutated Gene",
y = "Number of Mutations",
fill = "Cancer Driver Gene") +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
# gene with the highest number of mutations in cryptic STMN2 cases
STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
group_by(hugo_symbol) |>
mutate(n = n()) |>
mutate(proportion = n/sum(n)) |>
filter(n >= 10) |>
ggplot(aes(x = reorder(hugo_symbol, n), y = n,
# fill = cancer_driver_gene,
fill = known_or_novel_variant)) +
geom_col() +
coord_flip() +
labs(x = "Mutated Gene",
y = "Number of Mutations",
fill = "Cancer Driver Gene") +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
# gene with the highest number of mutations in cryptic STMN2 cases
STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
group_by(hugo_symbol, known_or_novel_variant) |>
mutate(n = n()) |>
mutate(proportion = n/sum(n)) |>
filter(n >= 10) |>
ggplot(aes(x = reorder(hugo_symbol, n), y = n,
# fill = cancer_driver_gene,
fill = known_or_novel_variant)) +
geom_col() +
coord_flip() +
labs(x = "Mutated Gene",
y = "Number of Mutations",
fill = "Cancer Driver Gene") +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
View(two_junc)
write.table(two_junc, file="two_junc.txt", sep=",")
write.table(two_junc, file="two_junc.txt", sep=",", quote=FALSE)
# comparing the general proportion of mutations in each gene to their proportion in the cases with >1 cryptic
gene_common_proportion <- mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "general_proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common",
TRUE ~ general_vs_common_cases
)) |>
filter(gene_mutation_count >= 100) |> View()
gene_common_proportion |> filter(general_vs_common_cases == "common") |> unique(case_submitter_id)
# comparing the general proportion of mutations in each gene to their proportion in the cases with >1 cryptic
gene_common_proportion <- mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "general_proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common",
TRUE ~ general_vs_common_cases
)) |>
filter(gene_mutation_count >= 100)
gene_common_proportion |> filter(general_vs_common_cases == "common") |> unique(case_submitter_id)
View(gene_common_proportion)
gene_common_proportion |> filter(general_vs_common_cases == "common") |> unique(case_submitter_id)
gene_common_proportion |> filter(general_vs_common_cases == "common") |> unique(case_submitter_id)
gene_common_proportion |> group_by(general_vs_common_cases) |> summarise(n = n())
gene_common_proportion |> group_by(general_vs_common_cases, case_submitter_id) |> summarise(n = n()) # 48 cases that have all
gene_common_proportion |> group_by(general_vs_common_cases, case_submitter_id) |> summarise(n = n()) |> View()# 48 cases that have all
gene_common_proportion|>
filter(gene_mutation_count >= 100) |>
ggplot(aes(x = reorder(gene, proportion),
y = proportion,
fill = general_vs_common_cases)) +
geom_col(position = "dodge") +
scale_y_continuous(labels = scales::percent_format()) +
stat_compare_means(comparisons = list(c("general", "common")),
label = "p.format",
method = "t.test",
paired = TRUE)
# fraction of mutations that are in cancer drivers vs non-drivers in each cancer type with cryptic STMN2
STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
group_by(cancer_abbrev, cancer_driver_gene) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = cancer_abbrev, y = proportion,
fill = cancer_driver_gene,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
labs(x = "Cancer Type",
y = "Percentage of Mutations",
fill = "Cancer Driver Gene",
title = "Mutations in Cancer Patients with Cryptic STMN2 Events") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 4) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
pdf("mutations_plots.pdf")
# fraction of mutations that are in cancer drivers vs non-drivers in each cancer type with cryptic STMN2
a<- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
group_by(cancer_abbrev, cancer_driver_gene) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = cancer_abbrev, y = proportion,
fill = cancer_driver_gene,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
labs(x = "Cancer Type",
y = "Percentage of Mutations",
fill = "Cancer Driver Gene",
title = "Mutations in Cancer Patients with Cryptic STMN2 Events") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 4) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
print(a)
# fraction of mutations that are known or novel in each cancer type with cryptic STMN2
# this plot is wrong - need help
b <- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(cancer_driver_gene == "cancer_driver") |>
group_by(cancer_abbrev, known_or_novel_variant) |>
mutate(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = known_or_novel_variant, y = proportion,
fill = known_or_novel_variant,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
facet_wrap(~cancer_abbrev) +
labs(x = "Variant Type",
y = "Percentage of Mutations",
fill = "Cancer Driver Gene",
title = "Mutations in Cancer Patients with Cryptic STMN2 Events") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 3) +
scale_y_continuous(labels = scales::percent_format()) +
theme(legend.position="bottom")
print(b)
# looking at polyphen scores - likelihood of mutations being damaging
c <- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(cancer_driver_gene=="cancer_driver") |>
filter(known_or_novel_variant=="known") |>
filter(consequence != "synonymous_variant") |>
separate(poly_phen, into = c("poly_phen", "poly_phen_value"), sep = "\\(|\\)") |>
filter(poly_phen != ".") |>
group_by(cancer_abbrev, poly_phen) |>
mutate(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = cancer_abbrev, y = proportion,
fill = poly_phen,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 3) +
scale_y_continuous(labels = scales::percent_format()) +
theme(legend.position="bottom")
print(c)
print(d)
# polyphen values
d <- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(cancer_driver_gene=="cancer_driver") |>
filter(known_or_novel_variant=="known") |>
filter(consequence != "synonymous_variant") |>
separate(poly_phen, into = c("poly_phen", "poly_phen_value"), sep = "\\(|\\)") |>
filter(poly_phen != ".") |>
mutate(poly_phen_value = as.numeric(poly_phen_value)) |>
ggplot(aes(x = cancer_abbrev, y = poly_phen_value,
fill = cancer_abbrev)) +
geom_boxplot(position = "dodge")
print(d)
# polyphen values in cancer drivers vs non-drivers
e <- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(known_or_novel_variant=="known") |>
filter(consequence != "synonymous_variant") |>
separate(poly_phen, into = c("poly_phen", "poly_phen_value"), sep = "\\(|\\)") |>
filter(poly_phen != ".") |>
mutate(poly_phen_value = as.numeric(poly_phen_value)) |>
ggplot(aes(x = cancer_abbrev, y = poly_phen_value,
fill = cancer_driver_gene)) +
geom_boxplot(position = "dodge")
print(e)
# gene with the highest number of mutations in cryptic STMN2 cases
# how can I add to this plot to show how many of those mutations are known vs novel?
f <- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
group_by(hugo_symbol) |>
mutate(n = n()) |>
mutate(proportion = n/sum(n)) |>
filter(n >= 10) |>
ggplot(aes(x = reorder(hugo_symbol, n), y = n,
fill = cancer_driver_gene)) +
geom_col() +
coord_flip() +
labs(x = "Mutated Gene",
y = "Number of Mutations",
fill = "Cancer Driver Gene") +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
print(f)
dev.off()
pdf(file="mutations_plots.pdf")
# fraction of mutations that are in cancer drivers vs non-drivers in each cancer type with cryptic STMN2
a<- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
group_by(cancer_abbrev, cancer_driver_gene) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = cancer_abbrev, y = proportion,
fill = cancer_driver_gene,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
labs(x = "Cancer Type",
y = "Percentage of Mutations",
fill = "Cancer Driver Gene",
title = "Mutations in Cancer Patients with Cryptic STMN2 Events") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 4) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
print(a)
print(b)
print(c)
print(d)
print(e)
print(f)
dev.off()
# comparing the general proportion of mutations in each gene to their proportion in the cases with >1 cryptic
gene_common_proportion <- mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "general_proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common",
TRUE ~ general_vs_common_cases
))
View(mutation_clinical_data)
View(lgg_mutations_orig)
View(STMN2_cryptic_cBio)
View(lgg_mutations)
# fraction of mutations that are known or novel in each cancer type with cryptic STMN2
# this plot is wrong - need help
STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(cancer_driver_gene == "cancer_driver") |>
group_by(cancer_abbrev, known_or_novel_variant) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n))
View(pcpg_mutations)
# fraction of mutations that are known or novel in each cancer type with cryptic STMN2
# this plot is wrong - need help
STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(cancer_driver_gene == "cancer_driver") |>
group_by(cancer_abbrev, known_or_novel_variant) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = known_or_novel_variant, y = proportion,
fill = known_or_novel_variant,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
facet_wrap(~cancer_abbrev) +
labs(x = "Variant Type",
y = "Percentage of Mutations",
fill = "",
title = "Mutations in Cancer Patients with Cryptic STMN2 Events") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 3) +
scale_y_continuous(labels = scales::percent_format()) +
theme(legend.position="bottom")
# gene with the highest number of mutations in cryptic STMN2 cases
# how can I add to this plot to show how many of those mutations are known vs novel?
f <- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
group_by(hugo_symbol) |>
summarise(n = n_distinct(case_submitter_id),
cancer_driver_gene)
View(f)
# gene with the highest number of mutations in cryptic STMN2 cases
# how can I add to this plot to show how many of those mutations are known vs novel?
f <- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
group_by(hugo_symbol) |>
summarise(n = n_distinct(case_submitter_id),
cancer_driver_gene) |> unique()
View(f)
# tidy mutation data downloaded from cBioPortal for single cancer type
tidy_mutation_data <- function(mutations_orig, cryptic_cBio) {
cancer_abbrev <- strsplit(deparse(substitute(mutations_orig)), "_")[[1]][1]
cryptic_event <- strsplit(deparse(substitute(cryptic_cBio)), "_")[[1]][1]
mutations <- mutations_orig |>
janitor::clean_names() |>
mutate(case_submitter_id = str_extract(tumor_sample_barcode, "([^-]+-[^-]+-[^-]+)")) |>
relocate(case_submitter_id, .before="hugo_symbol") |>
select(c(case_submitter_id, hugo_symbol, entrez_gene_id, chromosome, start_position, end_position, strand,
consequence, variant_type, reference_allele, tumor_seq_allele2, db_snp_rs, tumor_sample_barcode,
n_ref_count, n_alt_count, hgv_sc, hgv_sp, hgv_sp_short, transcript_id, protein_position,
amino_acids, biotype, canonical, exon, feature_type, gene, impact, poly_phen, sift, variant_class,
all_effects)) |>
mutate(ifelse(case_submitter_id %in% cryptic_cBio$case_submitter_id, "cryptic", "non-cryptic")) |>
mutate(cryptic_event = cryptic_event) |>
mutate(cancer_abbrev = cancer_abbrev) |>
relocate(cryptic_event, .before = "case_submitter_id") |>
relocate(cancer_abbrev, .after = "case_submitter_id")
return(mutations)
}
gene_mutation_proportions <- mutation_clinical_data |>
group_by(gene) |>
summarise(gene_mutation_count = n_distinct(case_submitter_id)) |>
mutate(general_proportion = gene_mutation_count / sum(gene_mutation_count))
common_cases_mutation_proportions <- mutation_clinical_data |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
group_by(gene) |>
summarise(common_cases_mutation_count = n_distinct(case_submitter_id)) |>
mutate(common_cases_proportion = common_cases_mutation_count / sum(common_cases_mutation_count))
# comparing the general proportion of mutations in each gene to their proportion in the cases with >1 cryptic
gene_common_proportion <- mutation_clinical_data |>
left_join(gene_mutation_proportions, by="gene") |>
left_join(common_cases_mutation_proportions, by="gene") |>
filter(case_submitter_id %in% all_common_cases$case_submitter_id) |>
filter(gene %in% cosmic_cancer_genes$Gene) |>
pivot_longer(cols = c(general_proportion, common_cases_proportion),
names_to = "general_vs_common_cases",
values_to = "proportion") |>
mutate(general_vs_common_cases = case_when(
general_vs_common_cases == "general_proportion" ~ "general",
general_vs_common_cases == "common_cases_proportion" ~ "common",
TRUE ~ general_vs_common_cases
))
gene_common_proportion|>
filter(gene_mutation_count >= 100) |>
ggplot(aes(x = reorder(gene, proportion),
y = proportion,
fill = general_vs_common_cases)) +
geom_col(position = "dodge") +
scale_y_continuous(labels = scales::percent_format()) +
stat_compare_means(comparisons = list(c("general", "common")),
label = "p.format",
method = "t.test", # no t-test, chi square
paired = TRUE)
gene_common_proportion|>
filter(gene_mutation_count >= 100) |>
ggplot(aes(x = reorder(gene, proportion),
y = proportion,
fill = general_vs_common_cases)) +
geom_col(position = "dodge") +
scale_y_continuous(labels = scales::percent_format())
print(last_plot())
