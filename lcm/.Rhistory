d_mutations <- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
filter(cancer_driver_gene == "cancer_driver") |>
group_by(cancer_abbrev, cryptic_or_non) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = cancer_abbrev, y = proportion,
fill = cryptic_or_non,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
labs(x = "Cancer Type",
y = "Percentage of Mutations",
title = "Mutations in Cancer Driver Genes",
fill = "Cryptic STMN2 Detected") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 4) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cryptic" = "tomato", "non-cryptic" = "dodgerblue")) +
theme(legend.position = "bottom")
print(d_mutations)
# fraction of mutations that are known or novel in each cancer type with cryptic STMN2
# this plot is wrong - need help
e_mutations <- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
filter(cryptic_or_non == "cryptic") |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
group_by(cancer_abbrev, known_or_novel_variant) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = known_or_novel_variant, y = proportion,
fill = known_or_novel_variant,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
facet_wrap(~cancer_abbrev) +
labs(x = "Variant Type",
y = "Percentage of Mutations",
fill = "",
title = "Mutations in Cancer Patients with Cryptic STMN2 Events") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 3) +
scale_y_continuous(labels = scales::percent_format()) +
theme(legend.position="bottom")
print(e_mutations)
# looking at polyphen scores - likelihood of mutations being damaging
f_mutations <- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(cancer_driver_gene=="cancer_driver") |>
filter(known_or_novel_variant=="known") |>
filter(consequence != "synonymous_variant") |>
separate(poly_phen, into = c("poly_phen", "poly_phen_value"), sep = "\\(|\\)") |>
filter(poly_phen != ".") |>
group_by(cancer_abbrev, poly_phen) |>
mutate(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = cancer_abbrev, y = proportion,
fill = poly_phen,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 3) +
scale_y_continuous(labels = scales::percent_format()) +
theme(legend.position="bottom")
print(f_mutations)
# polyphen values
g_mutations <- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(cancer_driver_gene=="cancer_driver") |>
filter(known_or_novel_variant=="known") |>
filter(consequence != "synonymous_variant") |>
separate(poly_phen, into = c("poly_phen", "poly_phen_value"), sep = "\\(|\\)") |>
filter(poly_phen != ".") |>
mutate(poly_phen_value = as.numeric(poly_phen_value)) |>
ggplot(aes(x = cancer_abbrev, y = poly_phen_value,
fill = cancer_abbrev)) +
geom_boxplot(position = "dodge")
print(g_mutations)
# polyphen values in cancer drivers vs non-drivers
h_mutations <- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(known_or_novel_variant=="known") |>
filter(consequence != "synonymous_variant") |>
separate(poly_phen, into = c("poly_phen", "poly_phen_value"), sep = "\\(|\\)") |>
filter(poly_phen != ".") |>
mutate(poly_phen_value = as.numeric(poly_phen_value)) |>
ggplot(aes(x = cancer_abbrev, y = poly_phen_value,
fill = cancer_driver_gene)) +
geom_boxplot(position = "dodge")
print(h_mutations)
i_mutations <- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
group_by(hugo_symbol, cryptic_or_non) |>
summarise(n = n_distinct(case_submitter_id),
cancer_driver_gene) |>
unique() |>
ungroup() |>
ggplot(aes(x = hugo_symbol, y = n,
fill = cancer_driver_gene)) +
geom_col() +
facet_wrap(~cryptic_or_non) +
labs(x = "Mutated Gene",
y = "Number of Mutations",
fill = "Cancer Driver Gene") +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
print(i_mutations)
j_mutations <- STMN2_pcpg_gbm_lgg_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(cryptic_or_non == "cryptic") |>
group_by(hugo_symbol) |> #hugo symbol and cryptic contain - n mutations and fraction --> chi square test
summarise(n = n_distinct(case_submitter_id),
cancer_driver_gene) |>
unique() |>
filter(n >= 10) |>
ungroup() |>
ggplot(aes(x = reorder(hugo_symbol, n), y = n,
fill = cancer_driver_gene)) +
geom_col() +
labs(x = "Mutated Gene",
y = "Number of Mutations",
fill = "Cancer Driver Gene") +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
print(j_mutations)
brca_mutations_orig <- read.table("brca_mutations.txt", sep="\t", head=TRUE)
esca_mutations_orig <- read.table("esca_mutations.txt", sep="\t", head=TRUE)
prad_mutations_orig <- read.table("prad_mutations.txt", sep="\t", head=TRUE)
brca_mutations <- tidy_mutation_data(brca_mutations_orig, ARHGAP32_cryptic_cBio)
esca_mutations_ARHGAP32 <- tidy_mutation_data(esca_mutations_orig, ARHGAP32_cryptic_cBio)
prad_mutations <- tidy_mutation_data(prad_mutations_orig, ARHGAP32_cryptic_cBio)
ARHGAP32_brca_esca_prad_mutations <- rbind(brca_mutations, esca_mutations_ARHGAP32, prad_mutations)
k_mutations <- ARHGAP32_brca_esca_prad_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
filter(cryptic_or_non == "cryptic") |>
group_by(cancer_abbrev, cancer_driver_gene) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = cancer_abbrev, y = proportion,
fill = cancer_driver_gene,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
labs(x = "Cancer Type",
y = "Percentage of Mutations",
fill = "Cancer Driver Gene",
title = "Mutations in Cancer Patients with Cryptic ARHGAP32 Events") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 4) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
print(k_mutations)
l_mutations <- ARHGAP32_brca_esca_prad_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
filter(cancer_driver_gene == "cancer_driver") |>
group_by(cancer_abbrev, cryptic_or_non) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = cancer_abbrev, y = proportion,
fill = cryptic_or_non,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
labs(x = "Cancer Type",
y = "Percentage of Mutations",
title = "Mutations in Cancer Driver Genes",
fill = "Cryptic ARHGAP32 Detected") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 4) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cryptic" = "tomato", "non-cryptic" = "dodgerblue")) +
theme(legend.position = "bottom")
print(l_mutations)
# fraction of mutations that are known or novel in each cancer type with cryptic STMN2
# this plot is wrong - need help
m_mutations <- ARHGAP32_brca_esca_prad_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
filter(cryptic_or_non == "cryptic") |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
group_by(cancer_abbrev, known_or_novel_variant) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = known_or_novel_variant, y = proportion,
fill = known_or_novel_variant,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
facet_wrap(~cancer_abbrev) +
labs(x = "Variant Type",
y = "Percentage of Mutations",
fill = "",
title = "Mutations in Cancer Patients with Cryptic ARHGAP32 Events") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 3) +
scale_y_continuous(labels = scales::percent_format()) +
theme(legend.position="bottom")
print(m_mutations)
write.table(ARHGAP32_brca_esca_prad_mutations, file="ARHGAP32_brca_esca_prad_mutations.txt", sep=",")
# looking at polyphen scores - likelihood of mutations being damaging
n_mutations <- ARHGAP32_brca_esca_prad_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(cancer_driver_gene=="cancer_driver") |>
filter(known_or_novel_variant=="known") |>
filter(consequence != "synonymous_variant") |>
separate(poly_phen, into = c("poly_phen", "poly_phen_value"), sep = "\\(|\\)") |>
filter(poly_phen != ".") |>
group_by(cancer_abbrev, poly_phen) |>
mutate(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = cancer_abbrev, y = proportion,
fill = poly_phen,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 3) +
scale_y_continuous(labels = scales::percent_format()) +
theme(legend.position="bottom")
print(n_mutations)
# polyphen values
o_mutations <- ARHGAP32_brca_esca_prad_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(cancer_driver_gene=="cancer_driver") |>
filter(known_or_novel_variant=="known") |>
filter(consequence != "synonymous_variant") |>
separate(poly_phen, into = c("poly_phen", "poly_phen_value"), sep = "\\(|\\)") |>
filter(poly_phen != ".") |>
mutate(poly_phen_value = as.numeric(poly_phen_value)) |>
ggplot(aes(x = cancer_abbrev, y = poly_phen_value,
fill = cancer_abbrev)) +
geom_boxplot(position = "dodge")
print(o_mutations)
# polyphen values in cancer drivers vs non-drivers
p_mutations <- ARHGAP32_brca_esca_prad_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(known_or_novel_variant=="known") |>
filter(consequence != "synonymous_variant") |>
separate(poly_phen, into = c("poly_phen", "poly_phen_value"), sep = "\\(|\\)") |>
filter(poly_phen != ".") |>
mutate(poly_phen_value = as.numeric(poly_phen_value)) |>
ggplot(aes(x = cancer_abbrev, y = poly_phen_value,
fill = cancer_driver_gene)) +
geom_boxplot(position = "dodge")
print(p_mutations)
q_mutations <- ARHGAP32_brca_esca_prad_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
group_by(hugo_symbol, cryptic_or_non) |>
summarise(n = n_distinct(case_submitter_id),
cancer_driver_gene) |>
unique() |>
ungroup() |>
ggplot(aes(x = hugo_symbol, y = n,
fill = cancer_driver_gene)) +
geom_col() +
facet_wrap(~cryptic_or_non) +
labs(x = "Mutated Gene",
y = "Number of Mutations",
fill = "Cancer Driver Gene") +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
print(q_mutations)
r_mutations <- ARHGAP32_brca_esca_prad_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(cryptic_or_non == "cryptic") |>
group_by(hugo_symbol) |> #hugo symbol and cryptic contain - n mutations and fraction --> chi square test
summarise(n = n_distinct(case_submitter_id),
cancer_driver_gene) |>
unique() |>
filter(n >= 10) |>
ungroup() |>
ggplot(aes(x = reorder(hugo_symbol, n), y = n,
fill = cancer_driver_gene)) +
geom_col() +
labs(x = "Mutated Gene",
y = "Number of Mutations",
fill = "Cancer Driver Gene") +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
print(r_mutations)
stad_mutations_orig <- read.table("stad_mutations.txt", sep="\t", head=TRUE)
esca_mutations_orig <- read.table("esca_mutations.txt", sep="\t", head=TRUE)
stad_mutations <- tidy_mutation_data(stad_mutations_orig, SYNJ2_cryptic_cBio)
esca_mutations_SYNJ2 <- tidy_mutation_data(esca_mutations_orig, SYNJ2_cryptic_cBio)
SYNJ2_stad_esca_mutations <- rbind(stad_mutations, esca_mutations_SYNJ2)
s_mutations <- SYNJ2_stad_esca_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
filter(cryptic_or_non == "cryptic") |>
group_by(cancer_abbrev, cancer_driver_gene) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = cancer_abbrev, y = proportion,
fill = cancer_driver_gene,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
labs(x = "Cancer Type",
y = "Percentage of Mutations",
fill = "Cancer Driver Gene",
title = "Mutations in Cancer Patients with Cryptic SYNJ2 Events") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 4) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
print(s_mutations)
t_mutations <- SYNJ2_stad_esca_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
filter(cancer_driver_gene == "cancer_driver") |>
group_by(cancer_abbrev, cryptic_or_non) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = cancer_abbrev, y = proportion,
fill = cryptic_or_non,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
labs(x = "Cancer Type",
y = "Percentage of Mutations",
title = "Mutations in Cancer Driver Genes",
fill = "Cryptic SYNJ2 Detected") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 4) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cryptic" = "tomato", "non-cryptic" = "dodgerblue")) +
theme(legend.position = "bottom")
print(t_mutations)
# fraction of mutations that are known or novel in each cancer type with cryptic STMN2
# this plot is wrong - need help
u_mutations <- SYNJ2_stad_esca_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
filter(cryptic_or_non == "cryptic") |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
group_by(cancer_abbrev, known_or_novel_variant) |>
summarise(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = known_or_novel_variant, y = proportion,
fill = known_or_novel_variant,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
facet_wrap(~cancer_abbrev) +
labs(x = "Variant Type",
y = "Percentage of Mutations",
fill = "",
title = "Mutations in Cancer Patients with Cryptic SYNJ2 Events") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 3) +
scale_y_continuous(labels = scales::percent_format()) +
theme(legend.position="bottom")
print(u_mutations)
write.table(SYNJ2_stad_esca_mutations, file="SYNJ2_stad_esca_mutations.txt", sep=",")
# looking at polyphen scores - likelihood of mutations being damaging
v_mutations <- SYNJ2_stad_esca_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(cancer_driver_gene=="cancer_driver") |>
filter(known_or_novel_variant=="known") |>
filter(consequence != "synonymous_variant") |>
separate(poly_phen, into = c("poly_phen", "poly_phen_value"), sep = "\\(|\\)") |>
filter(poly_phen != ".") |>
group_by(cancer_abbrev, poly_phen) |>
mutate(n = n()) |>
mutate(proportion = n/sum(n)) |>
ggplot(aes(x = cancer_abbrev, y = proportion,
fill = poly_phen,
label = scales::percent(proportion))) +
geom_col(position = "dodge") +
geom_text(position = position_dodge(width = .9),
vjust = -0.5,
size = 3) +
scale_y_continuous(labels = scales::percent_format()) +
theme(legend.position="bottom")
print(v_mutations)
# polyphen values
w_mutations <- SYNJ2_stad_esca_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(cancer_driver_gene=="cancer_driver") |>
filter(known_or_novel_variant=="known") |>
filter(consequence != "synonymous_variant") |>
separate(poly_phen, into = c("poly_phen", "poly_phen_value"), sep = "\\(|\\)") |>
filter(poly_phen != ".") |>
mutate(poly_phen_value = as.numeric(poly_phen_value)) |>
ggplot(aes(x = cancer_abbrev, y = poly_phen_value,
fill = cancer_abbrev)) +
geom_boxplot(position = "dodge")
print(w_mutations)
# polyphen values in cancer drivers vs non-drivers
x_mutations <- SYNJ2_stad_esca_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(known_or_novel_variant=="known") |>
filter(consequence != "synonymous_variant") |>
separate(poly_phen, into = c("poly_phen", "poly_phen_value"), sep = "\\(|\\)") |>
filter(poly_phen != ".") |>
mutate(poly_phen_value = as.numeric(poly_phen_value)) |>
ggplot(aes(x = cancer_abbrev, y = poly_phen_value,
fill = cancer_driver_gene)) +
geom_boxplot(position = "dodge")
print(x_mutations)
y_mutations <- SYNJ2_stad_esca_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
group_by(hugo_symbol, cryptic_or_non) |>
summarise(n = n_distinct(case_submitter_id),
cancer_driver_gene) |>
unique() |>
ungroup() |>
ggplot(aes(x = hugo_symbol, y = n,
fill = cancer_driver_gene)) +
geom_col() +
facet_wrap(~cryptic_or_non) +
labs(x = "Mutated Gene",
y = "Number of Mutations",
fill = "Cancer Driver Gene") +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
print(y_mutations)
z_mutations <- SYNJ2_stad_esca_mutations |>
mutate(cancer_driver_gene = ifelse(hugo_symbol %in% cosmic_cancer_genes$Gene,
'cancer_driver', 'non_driver')) |>
mutate(known_or_novel_variant =
ifelse(db_snp_rs == "novel", "novel",
ifelse(grepl("rs", db_snp_rs), "known", "no_info"))) |>
filter(cryptic_or_non == "cryptic") |>
group_by(hugo_symbol) |> #hugo symbol and cryptic contain - n mutations and fraction --> chi square test
summarise(n = n_distinct(case_submitter_id),
cancer_driver_gene) |>
unique() |>
filter(n >= 10) |>
ungroup() |>
ggplot(aes(x = reorder(hugo_symbol, n), y = n,
fill = cancer_driver_gene)) +
geom_col() +
labs(x = "Mutated Gene",
y = "Number of Mutations",
fill = "Cancer Driver Gene") +
scale_fill_manual(labels = c("Yes", "No"),
values = c("cancer_driver" = "tomato", "non_driver" = "dodgerblue"))
print(z_mutations)
dev.off()
