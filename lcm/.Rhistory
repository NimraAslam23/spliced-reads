STMN2_events_mutations <- read.table("STMN2_events_mutations.tsv", sep = "\t", header = TRUE, na.strings="")
write_clip(jir_new$gdc_cases.submitter_id)
install.packages("jsonlite")
install.packages("jsonlite")
install.packages("jsonlite")
library(jsonlite)
gh_users_json()
genes.2023-02-22_json()
genes.2023-02-22 (1)_json()
genes_json()
json()
read_json(STMN2_events_genes.json)
read_json("STMN2_events_genes.json")
read_json("STMN2_events_genes.json")
STMN2_events_genes <- read_json("STMN2_events_genes.json")
View(STMN2_events_genes)
tibble(STMN2_events_genes = parse_json(STMN2_events_genes))
library(tidyverse)
tibble(STMN2_events_genes = parse_json(STMN2_events_genes))
STMN2_events_genes <- tibble(STMN2_events_genes = parse_json(STMN2_events_genes))
View(STMN2_events_genes)
View(STMN2_events_genes)
STMN2_events_genes |>
unnest(wider(y))
STMN2_events_genes |>
unnest_wider(y)
rlang::last_error()
genes_df <- tribble(STMN2_events_genes)
View(STMN2_events_genes)
fromJSON(file = "STMN_events_genes")
fromJSON(file = "STMN_events_genes.json")
?fromJSON
fromJSON("STMN_events_genes.json")
fromJSON("STMN2_events_genes.json")
STMN2_events_genes <- fromJSON("STMN2_events_genes.json")
STMN2_events_genes <- read.table("STMN2_events_genes.tsv", sep = "\t", header = TRUE, na.strings="")
?read.table
STMN2_events_genes <- read.table("STMN2_events_genes.tsv", sep = "\t", header = TRUE, na.strings="", fill = TRUE)
STMN2_events_genes <- read.csv("STMN2_events_genes.tsv", sep = "\t", header = TRUE, na.strings="", fill = TRUE)
View(STMN2_events_genes)
STMN2_events_genes <- read.csv("STMN2_events_genes.tsv", sep = "\t", header = TRUE, na.strings="", fill = TRUE)
head(STMN2_events_genes)
head(STMN2_events_genes)
STMN2_events_genes |>
rename("affected_cases" = "X..SSM.Affected.Cases.in.Cohort")
library(tidyverse)
library(repurrrsive)
library(jsonlite)
library(clipr)
STMN2_events_genes |>
rename("affected_cases" = "X..SSM.Affected.Cases.in.Cohort")
STMN2_events_genes |>
rename("affected_cases_in_cohort" = "X..SSM.Affected.Cases.in.Cohort")
STMN2_events_genes <- STMN2_events_genes |>
rename("affected_cases_in_cohort" = "X..SSM.Affected.Cases.in.Cohort")
library(tidyverse)
library(repurrrsive)
library(jsonlite)
library(clipr)
jir_new$gdc_cases.submitter_id
write_clip(jir_new$gdc_cases.submitter_id)
STMN2_events_genes <- read.csv("STMN2_events_genes.tsv", sep = "\t", header = TRUE, na.strings="", fill = TRUE)
ptdp_orig <- ptdp_orig |>
rename("sample_name" = "sample")
STMN2_events_genes <- STMN2_events_genes |>
rename("affected_cases_in_cohort" = "X..SSM.Affected.Cases.in.Cohort")
View(STMN2_events_genes)
head(STMN2_events_genes)
View(STMN2_events_genes)
STMN2_events_genes <- STMN2_events_genes |>
rename("affected_cases_in_cohort" = "X..SSM.Affected.Cases.in.Cohort") |>
# number of cases where gene is mutated / number of cases tested for simple somatic mutations
rename("affected_cases_in_GDC" = "X..SSM.Affected.Cases.Across.the.GDC") |>
rename("CNV_gain" = "X..CNV.Gain") |>
rename("CNV_loss" = "X..CNV.Loss") |>
rename("muations" = "X..Mutations")
View(STMN2_events_genes)
STMN2_events_genes <- STMN2_events_genes |>
# number of cases where gene is mutated / number of cases tested for simple somatic mutations
rename("affected_cases_in_GDC" = "X..SSM.Affected.Cases.Across.the.GDC") |>
rename("CNV_gain" = "X..CNV.Gain") |>
rename("CNV_loss" = "X..CNV.Loss") |>
rename("muations" = "X..Mutations")
STMN2_events_genes <- STMN2_events_genes |>  rename("mutations" = "muations")
STMN2_events_gains |> hist(CNV_gain)
STMN2_events_genes |> hist(CNV_gain)
# join the jir for queried junctions with TCGA data
jir_new <- jir |>
left_join(samples_with_cryptic,by = c('sample_id' = 'rail_id'))
STMN2_events_mutations <- read.csv("STMN2_events_mutations.tsv", sep = "\t", header = TRUE, na.strings = "", fill = TRUE)
head(STMN2_events_mutations)
View(STMN2_events_mutations)
STMN2_events_mutations |>
separate(DNA.change, into = c("chromosome", "DNA_change"))
STMN2_events_mutations |>
separate(DNA.Change, into = c("chromosome", "DNA_change"))
STMN2_events_mutations |>
separate(DNA.Change, into = c("chromosome", "DNA_change", "base_change"))
STMN2_events_mutations |>
separate(DNA.Change, into = c("chromosome", "DNA_change", "base_before", "base_after"))
STMN2_events_mutations |>
separate(DNA.Change, into = c("chromosome", "DNA_change", "base_before", "base_after")) |>
separate(base_before, into = c("base_position", "base_before"))
STMN2_events_mutations |>
separate(DNA.Change, into = c("chromosome", "DNA_change", "base_before", "base_after")) |>
separate(base_before,
into = c("base_position", "base_before"),
sep = "(?<=[A-Za-z]) (?=[0-9])")
separate(Consequences, into = c("consequence", "gene", "amino_acid_change")
STMN2_events_mutations |>
STMN2_events_mutations |>
separate(Consequences, into = c("consequence", "gene", "amino_acid_change"))
STMN2_events_mutations |>
select(-Survival)
STMN2_events_mutations <- STMN2_events_mutations |> select(-Survival)
)
STMN2_events_mutations |>
grepl("Missense", Consequences), "missense",
STMN2_events_mutations |>
mutate(consequence = Consequences)
STMN2_events_mutations |>
for (value in Consequences) {
if(grepl("Missense", Consequences) {
STMN2_clinical <- read.csv("STMN2_clinical.tsv", sep = "\t", header = TRUE, na.strings = "", fill = TRUE)
View(STMN2_clinical)
STMN2_clinical |> distinct(cause_of_death)
STMN2_clinical |> distinct(classification_of_tumor)
View(STMN2_events_genes)
separate(affected_cases_in_cohort, into = c("#_affected_cases_in_cohort", "total", "%_affected_cases_in_cohort")
STMN2_events_genes |>
STMN2_events_genes |>
separate(affected_cases_in_cohort, into = c("#_affected_cases_in_cohort", "total", "%_affected_cases_in_cohort"))
STMN2_events_genes |>
affected_cases_in_cohort = as.numeric(affected_cases_in_cohort)
STMN2_events_genes |>
rename(affected_cases_in_cohort = as.numeric(affected_cases_in_cohort))
STMN2_events_genes |>
rename(affected_cases_in_cohort = as.numeric(affected_cases_in_cohort))
STMN2_events_genes |>
rename(CNV_gain = as.numeric(CNV_gain))
STMN2_events_genes |>
rename(CNV_gain = as.numeric(STMN2_events_genes$CNV_gain))
STMN2_events_genes |>
transform(CNV_gain = as.numeric(CNV_gain))
STMN2_events_genes |>
transform(CNV_gain = as.numeric(CNV_gain)) |>
separate(CNV_gain, into = c("number_of_CNV_gain", "total", "%_of_CNV_gain"))
STMN2_events_genes |>
transform(CNV_gain = as.numeric(CNV_gain)) |>
hist(CNV_gain)
STMN2_events_mutations_orig <- read.csv("STMN2_events_mutations.tsv", sep = "\t", header = TRUE, na.strings = "", fill = TRUE)
STMN2_events_mutations <- STMN2_events_mutations_orig
STMN2_events_mutations <- STMN2_events_mutations |>
select = c(case_submitter_id,project_id,age_at_index, ethnicity, gender, race, ajcc_pathologic_stage)
STMN2_events_mutations |>
select(case_submitter_id,project_id,age_at_index, ethnicity, gender, race, ajcc_pathologic_stage)
STMN2_events_mutations <- STMN2_events_mutations |>
select(case_submitter_id, project_id, age_at_index, ethnicity, gender, race, ajcc_pathologic_stage)
View(STMN2_events_mutations)
STMN2_clinical_orig <- read.csv("STMN2_clinical.tsv", sep = "\t", header = TRUE, na.strings = "", fill = TRUE)
head(STMN2_clinial_orig)
head(STMN2_clinical_orig)
STMN2_clinical <- STMN2_clinical_orig
STMN2_clinical <- STMN2_clinical|>
select(case_submitter_id, project_id, age_at_index, ethnicity, gender, race, ajcc_pathologic_stage)
View(STMN2_clinical)
STMN2_clinical <- STMN2_clinical|>
select(case_submitter_id, project_id, age_at_index, ethnicity, gender, race, ajcc_pathologic_stage) |>
replace(STMN2_clinical == `--, NA)
STMN2_clinical <- STMN2_clinical|>
select(case_submitter_id, project_id, age_at_index, ethnicity, gender, race, ajcc_pathologic_stage) |>
replace(STMN2_clinical == --, NA)
STMN2_clinical <- STMN2_clinical|>
select(case_submitter_id, project_id, age_at_index, ethnicity, gender, race, ajcc_pathologic_stage) |>
replace(STMN2_clinical == "'--", NA)
View(STMN2_clinical)
STMN2_clinical <- STMN2_clinical|>
select(case_submitter_id, project_id, age_at_index, ethnicity, gender, race, ajcc_pathologic_stage) |>
replace(ajcc_pathological_stage == "'--", NA)
STMN2_clinical <- STMN2_clinical|>
select(case_submitter_id, project_id, age_at_index, ethnicity, gender, race, ajcc_pathologic_stage) |>
replace(ajcc_pathologic_stage == "'--", NA)
STMN2_clinical <- replace(STMN2_clinical, ajcc_pathologic_stage=="'--", NA)
STMN2_clinical <- replace_with_na_at("--")
c
STMN2_clinical <- STMN2_clinical_orig
STMN2_clinical
library(tidyverse)
library(repurrrsive)
library(jsonlite)
library(clipr)
STMN2_clinical <- replace_with_na_at("--")
install.packages("naniar")
library(naniar)
STMN2_clinical <- replace_with_na_at("--")
STMN2_clinical <- replace_with_na_at(ajcc_pathologic_stage = "--")
(condition = ~.x == "--")
(condition = .x == "--")
replace_with_na(replace = list(ajcc_pathologic_stage = '--))
STMN2_clinical |>
replace_with_na(replace = list(ajcc_pathologic_stage = --))
xxxx
STMN2_clinical <- STMN2_clinical|>
select(case_submitter_id, project_id, age_at_index, ethnicity, gender, race, ajcc_pathologic_stage) |>
separate(project_id, into = c("project", "cancer_type"))
library(tidyverse)
library(repurrrsive)
library(jsonlite)
library(clipr)
library(naniar)
STMN2_clinical <- STMN2_clinical|>
select(case_submitter_id, project_id, age_at_index, ethnicity, gender, race, ajcc_pathologic_stage) |>
separate(project_id, into = c("project", "cancer_type"))
STMN2_clinical <- STMN2_clinical|>
select(case_submitter_id, project_id, age_at_index, ethnicity, gender, race, ajcc_pathologic_stage) |>
separate(project_id, into = c("project", "cancer_type")) |>
select(-project)
STMN2_clinical <- STMN2_clinical |> select(-project)
hist(STMN2_clinical$cancer_type)
ggplot(STMN2_clinical, aes(x = cancer_type)) +
geom_bar()
ggplot(STMN2_clinical, aes(x = cancer_type)) +
geom_bar() +
coord_flip()
library(repurrrsive)
library(jsonlite)
library(clipr)
library(naniar)
genes <- fromJSON(file="STMN2_events_genes.json")
genes <- fromJSON("STMN2_events_genes.json")
View(genes)
mutations <- fromJSON("STMN2_events_mutations.json")
View(mutations)
View(mutations[[1]][[1]])
STMN2_clinical |>
ggplot(STMN2_clinical, aes(x = cancer_type)) +
geom_bar() +
coord_flip() +
labs(
y = "Cancer Type",
title = "STMN2 cryptic events are found in mostly BRCA and LCG cancers" #BRCA = breast cancer, LCG = lung cancer
)
rlang::last_error()
rlang::last_trace()
STMN2_clinical |>
ggplot(STMN2_clinical, aes(x = cancer_type)) +
geom_bar() +
labs(
y = "Cancer Type",
title = "STMN2 cryptic events are found in mostly BRCA and LCG cancers" #BRCA = breast cancer, LCG = lung cancer
) +
coord_flip()
STMN2_clinical |>
ggplot(STMN2_clinical, aes(x = cancer_type)) +
geom_bar() +
labs(
y = "Cancer Type",
title = "STMN2 cryptic events are found in mostly BRCA and LCG cancers" #BRCA = breast cancer, LCG = lung cancer
)
STMN2_clinical |>
ggplot(STMN2_clinical, aes(x = cancer_type)) +
geom_bar() +
labs(
y = "Cancer Type",
title = "STMN2 cryptic events are found in mostly BRCA and LCG cancers"
)
STMN2_clinical |>
ggplot(aes(x = cancer_type)) +
geom_bar() +
labs(
y = "Cancer Type",
title = "STMN2 cryptic events are found in mostly BRCA and LCG cancers"
)
STMN2_clinical |>
ggplot(aes(x = cancer_type)) +
geom_bar() +
labs(
y = "Cancer Type",
title = "STMN2 cryptic events are found in mostly BRCA and LCG cancers"
) +
coord_flip()
STMN2_clinical |>
ggplot(aes(x = cancer_type)) +
geom_bar() +
labs(
x = "Cancer Type",
title = "STMN2 cryptic events are found in mostly BRCA and LCG cancers"
) +
coord_flip()
STMN2_clinical |>
ggplot(aes(x = cancer_type)) +
geom_bar() +
coord_flip() +
labs(
x = "Cancer Type",
title = "STMN2 cryptic events are found in mostly BRCA and LCG cancers"
)
STMN2_clinical |>
ggplot(aes(x = cancer_type)) +
geom_bar() +
coord_flip() +
labs(
x = "Cancer Type",
title = "STMN2 cryptic events are found in mostly breast and lung cancers"
)
STMN2_clinical |>
ggplot(aes(x = cancer_type)) +
geom_bar(color = cancer_type) +
coord_flip() +
labs(
x = "Cancer Type",
title = "STMN2 cryptic events are found in mostly breast and lung cancers"
)
STMN2_clinical |>
ggplot(aes(x = cancer_type)) +
geom_bar(aes(color = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
title = "STMN2 cryptic events are found in mostly breast and lung cancers"
)
STMN2_clinical |>
ggplot(aes(x = cancer_type)) +
geom_bar(aes(fill = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
title = "STMN2 cryptic events are found in mostly breast and lung cancers"
)
STMN2_clinical |>
ggplot(aes(x = cancer_type)) +
geom_bar(aes(fill = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
title = "STMN2 cryptic events are found in mostly breast and lung cancers"
) +
theme(legend-position = "none")
STMN2_clinical |>
ggplot(aes(x = cancer_type)) +
geom_bar(aes(fill = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
title = "STMN2 cryptic events are found in mostly breast and lung cancers"
) +
theme(legend-position == "none")
STMN2_clinical |>
ggplot(aes(x = cancer_type)) +
geom_bar(aes(fill = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
title = "STMN2 cryptic events are found in mostly breast and lung cancers"
) +
theme(legend.position == "none")
STMN2_clinical |>
ggplot(aes(x = cancer_type)) +
geom_bar(aes(fill = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
title = "STMN2 cryptic events are found in mostly breast and lung cancers"
) +
theme(legend.position = "none")
STMN2_clinical |>
ggplot(aes(x = cancer_type)) +
geom_bar(aes(fill = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
y = "Number of Cases",
title = "STMN2 cryptic events are found in mostly breast and lung cancers"
) +
theme(legend.position = "none")
library(ggpubr)
library(rstatix)
stat_test_cancer_type <-
STMN2_clinical |>
t_test(cancer_type ~ count)
View(jir_new)
jir_new <- jir_new |>
rename("case_submitter_id" = "gdc_cases.submitter_id")
STMN2_clinical_jir <- jir_new |>
left_join(STMN2_clinical, by=c("case_submitter_id"))
View(STMN2_clinical_jir)
View(STMN2_clinical_jir)
STMN2_clinical_jir <- select(-gdc_cases.diagnoses.tumor_stage, -age_at_index, -gdc_cases.demographic.gender, -ajcc_pathologic_stage, -ethnicity, -race)
STMN2_clinical_jir <- STMN2_clinical_jir |>
select(-gdc_cases.diagnoses.tumor_stage, -age_at_index, -gdc_cases.demographic.gender, -ajcc_pathologic_stage, -ethnicity, -race)
STMN2_clinical_jir <- STMN2_clinical_jir |> select(-cancer_type)
STMN2_clinical_jir <- STMN2_clinical_jir |>
rename("cancer_type" = "gdc_cases.project.name") |>
rename("gdc_primary_site" = "gdc_cases.project.primary_site") |>
rename("sample_type" = "gdc_cases.samples.sample_type") |>
rename("cgc_primary_site" = "cgc_case_primary_site")
STMN2_clinical_jir <- STMN2_clinical_jir |> select(-gender)
STMN2_clinical_jir |>
ggplot(aes(x = gdc_primary_site)) +
geom_bar(aes(fill = gdc_primary_site)) +
coord_flip() +
theme(legend.position = "none")
STMN2_clinical_jir |>
drop_na() |>
ggplot(aes(x = gdc_primary_site)) +
geom_bar(aes(fill = gdc_primary_site)) +
coord_flip() +
theme(legend.position = "none")
STMN2_clinical_jir |>
drop_na() |>
ggplot(aes(x = gdc_primary_site)) +
geom_bar(aes(fill = gdc_primary_site)) +
coord_flip() +
labs(
x = "Primary Site of Cancer",
y = "Number of Cases",
title = "Cancers with cryptic STMN2 events are found mostly in the breast and brain"
) +
theme(legend.position = "none")
STMN2_clinical_jir |>
drop_na() |>
ggplot(aes(x = cgc_primary_site, y = junction_avg_coverage)) +
geom_bar()
STMN2_clinical_jir |>
drop_na() |>
ggplot(aes(x = cgc_primary_site, y = junction_avg_coverage)) +
geom_boxplot()
STMN2_clinical_jir |>
drop_na() |>
ggplot(aes(x = fct_reorder(cgc_primary_site, junction_avg_coverage, median), y = junction_avg_coverage)) +
geom_boxplot()
STMN2_clinical_jir |>
drop_na() |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(cgc_primary_site, junction_avg_coverage, median))) +
geom_boxplot()
STMN2_clinical_jir |>
drop_na() |>
filter(samples != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(cgc_primary_site, junction_avg_coverage, median))) +
geom_boxplot()
STMN2_clinical_jir |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(cgc_primary_site, junction_avg_coverage, median))) +
geom_boxplot()
STMN2_clinical_jir |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(cgc_primary_site, junction_avg_coverage, median))) +
geom_boxplot() +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
)
STMN2_clinical_jir |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(cgc_primary_site, junction_avg_coverage, median))) +
geom_boxplot(aes(fill = cgc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
)
STMN2_clinical_jir |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(cgc_primary_site, junction_avg_coverage, median))) +
geom_boxplot(aes(fill = cgc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none")
?janitor::tabyl
STMN2_clinical_jir |>
janitor::tabyl(cancer_type)
STMN2_clinical_jir |>
drop_na() |>
janitor::tabyl(cancer_type)
source("~/Documents/GitHub/spliced-reads/lcm/TCGA_STMN2.R", echo=TRUE)
STMN2_clinical_jir |>
drop_na() |>
janitor:tabyl(gdc_primary_site)
STMN2_clinical_jir |>
drop_na() |>
janitor::tabyl(gdc_primary_site)
STMN2_clinical_jir |>
drop_na() |>
janitor::tabyl(cgc_primary_site)
STMN2_clinical_jir |>
drop_na() |>
filter(cgc_primary_site != "") |>
janitor::tabyl(cgc_primary_site)
STMN2_events_genes |>
transform(CNV_gain = as.numeric(CNV_gain)) |>
hist(CNV_gain)
View(STMN2_events_mutations)
STMN2_events_genes_orig <- read.csv("STMN2_events_genes.tsv", sep = "\t", header = TRUE, na.strings="", fill = TRUE)
head(STMN2_events_genes_orig)
STMN2_events_genes <- STMN2_events_genes_orig
STMN2_clinical_jir |>
drop_na() |>
janitor::tabyl(cancer_type)
STMN2_clinical_jir |>
drop_na() |>
janitor::tabyl(gdc_primary_site)
View(group_column)
View(genes)
STMN2_events_different_cancers <- STMN2_clinical_jir |>
drop_na() |>
janitor::tabyl(cancer_type)
View(STMN2_events_different_cancers)
