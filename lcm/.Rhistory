ptdp_orig |>
rename("sample" = "sample_name")
ptdp_orig |>
rename("sample_name" = "sample")
ptdp_orig <- ptdp_orig |>
rename("sample_name" = "sample")
spliced_reads |>
left_join(ptdp_orig, by = "sample_name")
spliced_reads_pdtp <- spliced_reads |>
left_join(ptdp_orig, by = "sample_name")
View(spliced_reads_pdtp)
spliced_reads_pdtp |>
select(sample_name, n_spliced_reads, junction_name, pTDP.43, MN_death, pTDP_category)
spliced_reads_pdtp_select <- spliced_reads_pdtp |>
select(sample_name, n_spliced_reads, junction_name, pTDP.43, MN_death, pTDP_category)
View(spliced_reads_pdtp_select)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point()
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death, na.rm = TRUE)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death), na.rm = TRUE) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death), na.rm = TRUE) +
geom_point(na.rm = TRUE) +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death), na.rm = TRUE) +
geom_point(na.rm = TRUE) +
facet_wrap(~pTDP_category, na.RM = TRUE)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(na.omit(spliced_reads_pdtp_select$MN_death), aes(x = n_spliced_reads, y = MN_death)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point() +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = n_spliced_reads, y = MN_death)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
mutate(mean_n_spliced_reads = mean(n_spliced_reads)) |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
facet_wrap(~pTDP_category)
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
facet_wrap(~pTDP_category)
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
labs(title = "STMN2 expression is higher in low MN_death") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
labs(
title = "STMN2 expression is higher in low MN_death",
x = "MN_death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point(position = "jitter") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43",
x = "MN_death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "MN_death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "MN_death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(dplyr)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_point(position = "jitter") +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = pTDP_category)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
hist(MNN_death)
hist(MN_death)
hist(spliced_reads_pdtp_select$MN_death)
spliced_reads_pdtp_select |>
ggplot(aes(x = MN_death)) +
geom_bar()
spliced_reads_pdtp_select |>
ggplot(aes(x = n_spliced_reads)) +
geom_bar()
spliced_reads_pdtp_select |>
hist(n_spliced_reads)
spliced_reads_pdtp_select |>
hist(x = n_spliced_reads)
hist(spliced_reads_pdtp_select$n_spliced_reads)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43", #what exactly do the values of 'pTDP.43' represent?
x = "Motor neuron death (%)", #what is this variable?
y = "Number of STMN2 spliced reads") +
facet_wrap(~pTDP_category)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = n_spliced_reads)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43",
x = "Motor neuron death (%)",
y = "Number of STMN2 spliced reads")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = n_spliced_reads)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43",
x = "pTDP-43 accumulation",
y = "Number of STMN2 spliced reads")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43",
x = "pTDP-43 accumulation",
y = "Number of STMN2 spliced reads")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 expression is higher with less phosphorylated TDP-43",
x = "pTDP-43 accumulation",
y = "Motor neuron death (%)")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "pTDP-43 levels do not affect levels of morphologically intact motor neurons",
x = "pTDP-43 accumulation",
y = "Motor neuron death (%)")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "pTDP-43 levels do not affect levels of viable motor neurons",
x = "pTDP-43 accumulation",
y = "Motor neuron death (%)")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "pTDP-43 levels do not affect viability of motor neurons",
x = "pTDP-43 accumulation",
y = "Motor neuron death (%)")
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = MN_death)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "pTDP-43 levels do not affect viability of motor neurons",
x = "pTDP-43 accumulation",
y = "Motor neuron death (%)")
stmn2_all_junctions_orig <- read.tsv("stmn2_all_junctions.bed")
stmn2_all_junctions_orig <- read_tsv("stmn2_all_junctions.bed")
View(stmn2_all_junctions_orig)
stmn2_all_junctions_orig <- read_tsv("stmn2_all_junctions.bed", col_names = FALSE)
View(stmn2_all_junctions_orig)
View(spliced_reads_pdtp_select)
View(spliced_reads_pdtp)
View(spliced_reads_pdtp_select)
stmn2_all_junctions_orig |>
col_names = c("chrosome", "start", "end", "sample_name", "n_spliced_reads", "strand")
stmn2_all_junctions_orig <- read_tsv("stmn2_all_junctions.bed", col_names = FALSE,
col_names = c("chrosome", "start", "end", "sample_name",
"n_spliced_reads", "strand"))
stmn2_all_junctions_orig <- read_tsv("stmn2_all_junctions.bed",
col_names = c("chrosome", "start", "end", "sample_name",
"n_spliced_reads", "strand"))
stmn2_all_junctions_orig <- read_tsv("stmn2_all_junctions.bed")
stmn2_all_junctions_orig <- read_tsv("stmn2_all_junctions.bed",
col_names = c("chrosome", "start", "end", "sample_name",
"n_spliced_reads", "strand"))
stmn2_all_junctions <- stmn2_all_junctions_orig
stmn2_all_junctions$sample_name <- gsub(".SJ.out", "", as.character(stmn2_all_junctions$sample_name))
View(stmn2_all_junctions_orig)
View(stmn2_all_junctions)
stmn2_all_junctions <- unique(stmn2_all_junctions_orig)
View(stmn2_all_junctions)
View(stmn2_all_junctions_orig)
stmn2_all_junctions$sample_name <- gsub(".SJ.out", "", as.character(stmn2_all_junctions$sample_name))
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp |>
left_join(stmn2_all_junctions, by = "sample_name")
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp |>
left_join(stmn2_all_junctions, by = "sample_name")
library(tidyverse)
library(ggplot2)
library(tidyr)
library(dplyr)
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp |>
left_join(stmn2_all_junctions, by = "sample_name")
View(spliced_reads_pdtp_stmn2)
View(stmn2_all_junctions_orig)
View(spliced_reads_pdtp_stmn2)
View(spliced_reads_pdtp_select)
View(spliced_reads_pdtp)
View(spliced_reads_pdtp)
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp |>
semi_join(stmn2_all_junctions, by=("sample_name"))
View(spliced_reads_pdtp_stmn2)
spliced_reads_pdtp_stmn2 <- stmn2_all_junctions |>
semi_join(spliced_reads_pdtp, by=("sample_name"))
View(spliced_reads_pdtp_stmn2)
View(spliced_reads_pdtp)
View(spliced_reads_pdtp_select)
spliced_reads_pdtp_stmn2 <- stmn2_all_junctions |>
left_join(spliced_reads_pdtp, by=c("sample_name", "chrosome", "start", "end", "n_spliced_reads", "strand"))
View(spliced_reads_pdtp_stmn2)
mean_per_junction |>
semi_join(significant_junctions, by=("junction_name")) |>
mutate(higher_value = ifelse(ALS>control,"ALS","control")) |>
separate(junction_name, sep = '\\|',into = c("gene","junc_cat","n_datasets_junction_found"),convert = TRUE) |>
ggplot(aes(x = junc_cat, fill = higher_value)) +
geom_bar() +
labs(
title = "Number of junctions significantly higher in ALS and controls",
x = "Junction category",
y = "Number of junctions",
color = "Group",
)
View(significant_junctions)
spliced_reads_pdtp_stmn2 |>
mutate(disease = ifelse(grepl("ALS", sample_name),
"ALS",
"control"))
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(disease = ifelse(grepl("ALS", sample_name),
"ALS",
"control"))
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(disease = ifelse(grepl("ALS", sample_name),
"ALS",
"control")) |>
relocate(disease, .after = sample_name)
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(disease = ifelse(grepl("ALS", sample_name),
"ALS",
"Control")) |>
relocate(disease, .after = sample_name)
View(significant_junctions)
View(significant_junctions[[2]][[1]])
spliced_reads_pdtp_stmn2 |>
mutate(higher_value = ifelse(ALS>control, "ALS", "control"))
mean_per_junction |>
semi_join(significant_junctions, by=("junction_name")) |>
mutate(higher_value = ifelse(ALS>control,"ALS","control")) |>
separate(junction_name, sep = '\\|',into = c("gene","junc_cat","n_datasets_junction_found"),convert = TRUE) |>
janitor::tabyl(junc_cat,higher_value)
spliced_reads_pdtp_stmn2 |>
mutate(higher_value = ifelse(ALS>control, "ALS", "control")) |>
separate(junction_name, sep = "\\|", into = c("gene", "junc_cat", "n_datasets_junction_found"), convert = TRUE) |>
janitor::tabyl(junc_cat, higher_value)
View(stmn2_all_junctions_orig)
source("~/Documents/GitHub/spliced-reads/lcm/spliced_read_from_lcm.R", echo=TRUE)
spliced_reads_pdtp_stmn2 |>
group_by(junction_name, disease) |>
mutate(mean_n_spliced_reads = mean(n_spliced_reads)) |>
ungroup() |>
select(junction_name, disease, mean_n_spliced_reads) |>
unique() |>
pivot_wider(names_from = "disease",
values_from = "mean_n_spliced_reads")
spliced_reads_pdtp_stmn2 |>
mutate(higher_value = ifelse(ALS>control, "ALS", "control")) |>
separate(junction_name, sep = "\\|", into = c("gene", "junc_cat", "n_datasets_junction_found"), convert = TRUE) |>
janitor::tabyl(junc_cat, higher_value)
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
group_by(junction_name, disease) |>
mutate(mean_n_spliced_reads = mean(n_spliced_reads)) |>
ungroup() |>
select(junction_name, disease, mean_n_spliced_reads) |>
unique() |>
pivot_wider(names_from = "disease",
values_from = "mean_n_spliced_reads")
spliced_reads_pdtp_stmn2 |>
mutate(higher_value = ifelse(ALS>control, "ALS", "control")) |>
separate(junction_name, sep = "\\|", into = c("gene", "junc_cat", "n_datasets_junction_found"), convert = TRUE) |>
janitor::tabyl(junc_cat, higher_value)
spliced_reads_pdtp_stmn2 |>
mutate(higher_value = ifelse(ALS>Control, "ALS", "Control")) |>
separate(junction_name, sep = "\\|", into = c("gene", "junc_cat", "n_datasets_junction_found"), convert = TRUE) |>
janitor::tabyl(junc_cat, higher_value)
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(disease = ifelse(grepl("ALS", sample_name),
"ALS",
"Control")) |>
relocate(disease, .after = sample_name)
stmn2_all_junctions_orig <- read_tsv("stmn2_all_junctions.bed",
col_names = c("chrosome", "start", "end", "sample_name",
"n_spliced_reads", "strand"))
stmn2_all_junctions <- unique(stmn2_all_junctions_orig)
stmn2_all_junctions$sample_name <- gsub(".SJ.out", "", as.character(stmn2_all_junctions$sample_name))
spliced_reads_pdtp_stmn2 <- stmn2_all_junctions |>
left_join(spliced_reads_pdtp, by=c("sample_name", "chrosome", "start",
"end", "n_spliced_reads", "strand"))
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(disease = ifelse(grepl("ALS", sample_name),
"ALS",
"Control")) |>
relocate(disease, .after = sample_name)
