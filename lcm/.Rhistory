#write_clip(jir_new$case_submitter_id)
# Chunk 4: Import gene data from TCGA
STMN2_events_genes_orig <- read.csv("STMN2_events_genes.tsv", sep = "\t", header = TRUE, na.strings="", fill = TRUE)
head(STMN2_events_genes_orig)
STMN2_events_genes <- STMN2_events_genes_orig
STMN2_events_genes <- STMN2_events_genes |>
rename("affected_cases_in_cohort" = "X..SSM.Affected.Cases.in.Cohort") |>
# number of cases where gene is mutated / number of cases tested for simple somatic mutations (3,259)
rename("affected_cases_in_GDC" = "X..SSM.Affected.Cases.Across.the.GDC") |>
# number of cases where gene contains simple somatic mutations / number of cases tested for simple somatic mutations portal wide (13,714)
rename("CNV_gain" = "X..CNV.Gain") |>
# number of cases where CNV gain observed in gene / number of cases tested for copy number alteration in gene (3,344)
rename("CNV_loss" = "X..CNV.Loss") |>
# number of cases where CNV loss observed in gene / number of cases tested for copy number alteration in gene (3,344)
rename("mutations" = "X..Mutations")
# unique simple somatic mutations in the gene in cohort
# Chunk 5: Import mutation data from TCGA
STMN2_events_mutations_orig <- read.csv("STMN2_events_mutations.tsv", sep = "\t", header = TRUE, na.strings = "", fill = TRUE)
head(STMN2_events_mutations_orig)
STMN2_events_mutations <- STMN2_events_mutations_orig
# Chunk 6: Import clinical data from TCGA
STMN2_clinical_orig <- read.csv("STMN2_clinical.tsv", sep = "\t", header = TRUE, na.strings = "", fill = TRUE)
head(STMN2_clinical_orig)
STMN2_clinical <- STMN2_clinical_orig
STMN2_clinical <- STMN2_clinical|>
select(case_submitter_id, project_id, age_at_index, ethnicity, gender, race, ajcc_pathologic_stage) |>
separate(project_id, into = c("project", "cancer_type")) |>
select(-project)
# Chunk 7: bar plot - cancer types with cryptic STMN2 events
STMN2_clinical |>
>>>>>>> parent of 5702c87 (mutation and patient info for all mutations)
ggplot(aes(x = fct_rev(fct_infreq(cancer_type)))) +
geom_bar() +
coord_flip() +
labs(
x = "Cancer Type",
y = "Number of Cases",
title = ""
) +
<<<<<<< HEAD
theme(plot.title = element_text(size=10))
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(repurrrsive)
library(jsonlite)
library(clipr)
library(naniar)
library(ggpubr)
library(rstatix)
library(ggplot2)
library(tidyr)
library(dplyr)
library(knitr)
library(snapcount)
library(ggsignif)
# Chunk 2: querying for cryptic and annotated SYNJ2 reads
SYNJ2_cryptic_query <- count_query(gene_name = "SYNJ2", snapcount_coords = "chr6:158017291-158019983", strand_code = "+")
SYNJ2_clinical_jir_cryptic |>
drop_na() |>
ggplot(aes(x = fct_rev(fct_infreq(gdc_primary_site)))) +
geom_bar() +
coord_flip() +
labs(
x = "Primary Site of Cancer",
y = "Number of Cases",
title = ""
) +
theme(plot.title = element_text(size=10))
SYNJ2_clinical_jir_cryptic |>
drop_na() |>
ggplot(aes(x = cryptic_count,
y = fct_reorder(gdc_primary_site, cryptic_count, median))) +
geom_boxplot() +
labs(
x = "SYNJ2 Cryptic Coverage",
y = "Primary Site of Cancer"
) +
theme(plot.title = element_text(size=10))
SYNJ2_events_different_cancers <- SYNJ2_clinical_jir_cryptic |>
drop_na() |>
janitor::tabyl(cancer_type) |> arrange(-percent)
View(SYNJ2_events_different_cancers)
View(SYNJ2_events_primary_sites)
SYNJ2_cryptic_cBio <- SYNJ2_cryptic_cBio |>
mutate_at("mutation_count", as.numeric)
SYNJ2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 500) |>
ggplot(aes(x = fct_reorder(cancer_abbrev, mutation_count, median),
y = mutation_count)) +
geom_boxplot() +
labs(
x = "Cancer Type",
y = "Mutation Count",
title = ""
)
SYNJ2_cryptic_cBio <- SYNJ2_cryptic_cBio |>
mutate_at("mutation_count", as.numeric)
SYNJ2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 500) |>
ggplot(aes(x = fct_reorder(cancer_abbrev, mutation_count, median),
y = mutation_count)) +
geom_boxplot() +
labs(
x = "Cancer Type",
y = "Mutation Count"
) +
geom_signif(comparisons = list(c("ESCA", "HNSC")),
map_signif_level = TRUE,
y_position = c(400))
SYNJ2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 300) |>
ggplot(aes(x = as.factor(cryptic_count),
y = mutation_count)) +
geom_boxplot() +
labs(
x = "Number of SYNJ2 cryptic events",
y = "Mutation Count"
)
ARHGAP32_cryptic_cBio <- ARHGAP32_cryptic_cBio |>
mutate_at("mutation_count", as.numeric)
ARHGAP32_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 2000) |>
ggplot(aes(x = fct_reorder(cancer_abbrev, mutation_count, median),
y = mutation_count)) +
geom_boxplot() +
coord_flip() +
labs(
x = "Cancer Type",
y = "Mutation Count"
) +
geom_signif(comparisons = list(c("SKCM", "COAD"),("COAD", "LUAD")),
ARHGAP32_cryptic_cBio <- ARHGAP32_cryptic_cBio |>
mutate_at("mutation_count", as.numeric)
ARHGAP32_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 2000) |>
ggplot(aes(x = fct_reorder(cancer_abbrev, mutation_count, median),
y = mutation_count)) +
geom_boxplot() +
coord_flip() +
labs(
x = "Cancer Type",
y = "Mutation Count"
) +
geom_signif(comparisons = list(c("SKCM", "COAD"),c("COAD", "LUAD")),
map_signif_level = TRUE,
y_position = c(1750, 1500))
SYNJ2_cryptic_cBio <- SYNJ2_cryptic_cBio |>
mutate_at("mutation_count", as.numeric)
SYNJ2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 500) |>
ggplot(aes(x = fct_reorder(cancer_abbrev, mutation_count, median),
y = mutation_count)) +
geom_boxplot() +
coord_flip() +
labs(
x = "Cancer Type",
y = "Mutation Count"
) +
geom_signif(comparisons = list(c("ESCA", "HNSC")),
map_signif_level = TRUE,
y_position = c(400))
SYNJ2_cryptic_cBio <- SYNJ2_cryptic_cBio |>
mutate_at("mutation_count", as.numeric)
SYNJ2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 500) |>
ggplot(aes(x = fct_reorder(cancer_abbrev, mutation_count, median),
y = mutation_count)) +
geom_boxplot() +
coord_flip() +
labs(
x = "Cancer Type",
y = "Mutation Count"
) +
geom_signif(comparisons = list(c("ESCA", "HNSC")),
map_signif_level = TRUE,
y_position = c(500))
SYNJ2_cryptic_cBio <- SYNJ2_cryptic_cBio |>
mutate_at("mutation_count", as.numeric)
SYNJ2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 500) |>
ggplot(aes(x = fct_reorder(cancer_abbrev, mutation_count, median),
y = mutation_count)) +
geom_boxplot() +
coord_flip() +
labs(
x = "Cancer Type",
y = "Mutation Count"
) +
geom_signif(comparisons = list(c("ESCA", "HNSC")),
map_signif_level = TRUE,
y_position = c(470))
SYNJ2_cryptic_cBio <- SYNJ2_cryptic_cBio |>
mutate_at("mutation_count", as.numeric)
SYNJ2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 500) |>
ggplot(aes(x = fct_reorder(cancer_abbrev, mutation_count, median),
y = mutation_count)) +
geom_boxplot() +
coord_flip() +
labs(
x = "Cancer Type",
y = "Mutation Count"
) +
geom_signif(comparisons = list(c("ESCA", "HNSC")),
map_signif_level = TRUE,
y_position = c(450))
SYNJ2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 300) |>
ggplot(aes(x = as.factor(cryptic_count),
y = mutation_count)) +
geom_boxplot() +
labs(
x = "Number of SYNJ2 cryptic events",
y = "Mutation Count"
) +
geom_signif(comparisons = list(c("8", "9")),
map_signif_level = TRUE,
y_position = c(230))
SYNJ2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 300) |>
ggplot(aes(x = as.factor(cryptic_count),
y = mutation_count)) +
geom_boxplot() +
labs(
x = "Number of SYNJ2 cryptic events",
y = "Mutation Count"
) +
geom_signif(comparisons = list(c("8", "9"), c("7","9")),
map_signif_level = TRUE,
y_position = c(230,200))
SYNJ2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 500) |>
ggplot(aes(x = cryptic_count,
y = mutation_count)) +
geom_hex() +
labs(
x = "Number of SYNJ2 cryptic events",
y = "Mutation Count"
)
SYNJ2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 300) |>
ggplot(aes(x = as.factor(cryptic_count),
y = mutation_count)) +
geom_boxplot() +
labs(
x = "Number of SYNJ2 cryptic events",
y = "Mutation Count"
) +
geom_signif(comparisons = list(c("8", "9"), c("7","9")),
map_signif_level = TRUE,
y_position = c(230,200))
SYNJ2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 300) |>
ggplot(aes(x = as.factor(cryptic_count),
y = mutation_count)) +
geom_boxplot() +
labs(
x = "Number of SYNJ2 cryptic events",
y = "Mutation Count"
) +
geom_signif(comparisons = list(c("8", "9"), c("7","9")),
map_signif_level = TRUE,
y_position = c(230,210))
View(SYNJ2_cryptic_cBio)
SYNJ2_cryptic_cBio |>
drop_na() |>
unique() |>
filter(mutation_count < 300) |>
ggplot(aes(x = as.factor(cryptic_count),
y = mutation_count)) +
geom_boxplot() +
labs(
x = "Number of SYNJ2 cryptic events",
y = "Mutation Count"
) +
geom_signif(comparisons = list(c("8", "9"), c("7","9")),
map_signif_level = TRUE,
y_position = c(230,210))
View(STMN2_ARHGAP32_SYNJ2_combined)
View(cosmic_all_mutations_census_genes_orig)
=======
theme(legend.position = "none", plot.title = element_text(size=10))
# Chunk 8: joining jir table with clinical table
STMN2_clinical_jir <- jir_new |>
left_join(STMN2_clinical, by=c("case_submitter_id"))
STMN2_clinical_jir <- STMN2_clinical_jir |>
select(-gdc_cases.diagnoses.tumor_stage, -age_at_index, -gdc_cases.demographic.gender,
-ajcc_pathologic_stage, -ethnicity, -race, -cancer_type, -gender)
STMN2_clinical_jir <- STMN2_clinical_jir |>
rename("cancer_type" = "gdc_cases.project.name") |>
rename("gdc_primary_site" = "gdc_cases.project.primary_site") |>
rename("sample_type" = "gdc_cases.samples.sample_type") |>
rename("cgc_primary_site" = "cgc_case_primary_site")
# Chunk 9: filter for cryptic coverage 2
STMN2_clinical_jir_cryptic <- STMN2_clinical_jir |>
filter(STMN2_cryptic_coverage > 2)
# Chunk 10: bar plot - primary sites of cancers with cryptic STMN2 events
STMN2_clinical_jir_cryptic |>
drop_na() |>
ggplot(aes(x = fct_rev(fct_infreq(gdc_primary_site)))) +
geom_bar(aes(fill = gdc_primary_site)) +
coord_flip() +
labs(
x = "Primary Site of Cancer",
y = "Number of Cases",
title =
"Primary sites of cancers with cryptic STMN2 events are mostly the adrenal gland and brain"
) +
theme(legend.position = "none", plot.title = element_text(size=9))
# Chunk 11: boxplot - overall STMN2 junction coverage in different cancer sites
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast"), c("Stomach", "Brain")),
map_signif_level = TRUE,
y_position = c(75, 80))
# Chunk 12: boxplot - cryptic STMN2 expression in different cancer sites
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = STMN2_cryptic_coverage,
y = fct_reorder(gdc_primary_site, STMN2_cryptic_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10))
# Chunk 13: number / fraction of cases with STMN2 events in different cancers
STMN2_events_different_cancers <- STMN2_clinical_jir_cryptic |>
drop_na() |>
janitor::tabyl(cancer_type) |> arrange(-percent)
kable(STMN2_events_different_cancers,
caption = "Breast and brain cancers have high cryptic STMN2 expression.")
# Chunk 14: number / fraction of cases with STMN2 events in different primary cancer sites
STMN2_events_primary_sites1 <- STMN2_clinical_jir_cryptic |>
drop_na() |>
janitor::tabyl(gdc_primary_site) |> arrange(-percent)
kable(STMN2_events_primary_sites1, caption = "Cancers with cryptic STMN2 events are found primarily in the adrenal gland and brain")
# Chunk 15: data import - TCGA Clinical Data
TCGA_all_clinical_orig <- read.csv("TCGA_all_clinical.tsv", sep = "\t", header = TRUE, na.strings = "", fill = TRUE)
head(TCGA_all_clinical_orig)
TCGA_clinical <- TCGA_all_clinical_orig
TCGA_clinical <- TCGA_clinical|>
select(case_submitter_id, project_id, age_at_index, ethnicity, gender, race, ajcc_pathologic_stage) |>
separate(project_id, into = c("project", "cancer_type")) |>
select(-project)
# Chunk 16: data import - cBioPortal Clinical Data
cBio_all_clinical_orig <- read.csv("cBio_clinical_data.tsv", sep = "\t", header = TRUE, na.strings = "", fill = TRUE)
cBio_clinical <- cBio_all_clinical_orig
cBio_clinical <- cBio_clinical |>
select(Study.ID, Patient.ID, Sample.ID, Aneuploidy.Score, Cancer.Type, TCGA.PanCanAtlas.Cancer.Type.Acronym, Cancer.Type.Detailed,
Months.of.disease.specific.survival, Mutation.Count, Overall.Survival..Months.)
cBio_clinical <- cBio_clinical |>
rename("case_submitter_id" = "Patient.ID") |>
rename("cancer" = "Cancer.Type.Detailed") |>
rename("cancer_abbrev" = "TCGA.PanCanAtlas.Cancer.Type.Acronym")
# Chunk 17: join cBio clinical data with STMN2 cryptic table
STMN2_cryptic_cBio <- STMN2_clinical_jir_cryptic |>
left_join(cBio_clinical, by = "case_submitter_id")
STMN2_cryptic_cBio <- STMN2_cryptic_cBio |>
select(-cgc_primary_site, -Cancer.Type, -Sample.ID, -Overall.Survival..Months.) |>
rename("disease_survival_months" = "Months.of.disease.specific.survival") |>
relocate(case_submitter_id, .after = sample_id) |>
relocate(cancer_type, .after = case_submitter_id) |>
relocate(gdc_primary_site, .after = cancer_abbrev) |>
relocate(sample_type, .after = gdc_primary_site) |>
janitor::clean_names()
# Chunk 18: calculate mean n mutations for each cancer type
STMN2_cryptic_cBio_mutations <- STMN2_cryptic_cBio |>
drop_na() |>
filter(mutation_count !="NA") |>
group_by(cancer_type) |>
mutate(mean_mutation_count = mean(as.numeric(mutation_count))) |>
ungroup() |>
select(cancer_type, cancer_abbrev, mean_mutation_count) |>
unique()
# Chunk 19: bar chart - n mutations for each cancer type
STMN2_cryptic_cBio_mutations |>
ggplot(aes(x = fct_reorder(cancer_abbrev, mean_mutation_count, median), y = mean_mutation_count)) +
geom_bar(stat = 'identity', aes(fill = cancer_abbrev)) +
labs(
x = "Cancer Type",
y = "Mean Mutation Count",
title = "Glioblastoma Multiforme has the greatest number of mutations"
) +
theme(legend.position = "none")
# Chunk 20: data import
patient_mutations_orig <- read.csv("TCGA-A5-A0G2_mutations.tsv", sep = "\t", header = TRUE, na.strings = "", fill = TRUE)
patient_mutations <- patient_mutations_orig |>
select(Gene, Protein.Change, Annotation, Functional.Impact, Chromosome, Start.Pos, End.Pos, Ref, Var, HGVSg, Mutation.Type, Variant.Type, Allele.Freq)
# Chunk 21: number of mutations in each gene
patient_mutations |>
count(Gene, sort = TRUE) |>
filter(n > 17) |>
ggplot(aes(x = fct_reorder(Gene, n, mean), y = n)) +
geom_bar(stat = 'identity', aes(fill = Gene)) +
labs(
x = "Gene",
y = "Mutation Count"
) +
theme(legend.position = "none")
# Chunk 22: types of mutations in TTN
patient_mutations |>
filter(Gene == "TTN") |>
ggplot(aes(x = fct_rev(fct_infreq(Mutation.Type)))) +
geom_bar(aes(fill = Mutation.Type)) +
labs(
x = "Mutation Type",
y = "Count in TTN Gene"
) +
theme(legend.position = "none")
STMN2_cryptic_cBio <- STMN2_cryptic_cBio |>
mutate_at("mutation_count", as.numeric)
STMN2_cryptic_cBio |>
drop_na() |>
ggplot(aes(x = stmn2_cryptic_coverage, y = mutation_count)) +
labs(
x = "Number of STMN2 cryptic events",
y = "Mutation Count"
) +
geom_point()
STMN2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 2500)
ggplot(aes(x = stmn2_cryptic_coverage, y = mutation_count)) +
labs(
x = "Number of STMN2 cryptic events",
y = "Mutation Count"
) +
geom_col()
View(cosmic_cancer_genes)
View(cosmic_patient_mutations)
View(patient_mutations)
View(patient_mutations_orig)
View(STMN2_clinical_jir_cryptic)
ggplot(aes(x = stmn2_cryptic_coverage, y = mutation_count)) +
labs(
x = "Number of STMN2 cryptic events",
y = "Mutation Count"
) +
geom_col()
ggplot(aes(x = stmn2_cryptic_coverage, y = mutation_count)) +
labs(
x = "Number of STMN2 cryptic events",
y = "Mutation Count"
) +
geom_point()
rlang::last_error()
STMN2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 2500) |>
ggplot(aes(x = stmn2_cryptic_coverage, y = mutation_count)) +
labs(
x = "Number of STMN2 cryptic events",
y = "Mutation Count"
) +
geom_point()
STMN2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 2500) |>
ggplot(aes(x = stmn2_cryptic_coverage, y = mutation_count)) +
labs(
x = "Number of STMN2 cryptic events",
y = "Mutation Count"
) +
geom_point()
STMN2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 750) |>
ggplot(aes(x = stmn2_cryptic_coverage, y = mutation_count)) +
labs(
x = "Number of STMN2 cryptic events",
y = "Mutation Count"
) +
geom_point()
STMN2_cryptic_cBio |>
drop_na() |>
filter(mutation_count < 750, stmn2_cryptic_coverage < 10) |>
ggplot(aes(x = stmn2_cryptic_coverage, y = mutation_count)) +
labs(
x = "Number of STMN2 cryptic events",
y = "Mutation Count"
) +
geom_point()
View(cosmic_patient_mutations)
View(STMN2_clinical_jir_cryptic)
View(STMN2_cryptic_cBio_mutations)
>>>>>>> parent of 5702c87 (mutation and patient info for all mutations)
