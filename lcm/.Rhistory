x = "Cancer Type",
y = "Average number of mutations per case",
fill = ""
) +
scale_fill_manual(values = c("avg_mutation_per_case" = "violetred4", "avg_mutation_per_case_cryptic" = "royalblue1"),
labels = c("All Cases", "STMN2 Cryptic Cases only"))
View(pancancer_all_clinical_orig)
View(pancancer_all_clinical_orig)
View(pancancer_clinical)
View(STMN2_clinical_jir)
View(cBio_clinical)
pancancer_clinical
View(SYNJ2_clinical_jir_cryptic)
View(SYNJ2_cryptic_cBio)
View(cBio_clinical_2)
View(pancancer_all_clinical_orig)
View(cBio_clinical)
View(cBio_clinical_2)
View(cBio_clinical)
View(cBio_clinical_2)
View(cBio_clinical)
View(cBio_clinical_2)
View(total_mutations_each_cancer)
total_mutations_each_cancer <- cBio_clinical_2 |>
drop_na(Mutation.Count) |>
filter(grepl("^\\d+$", Mutation.Count)) |>
group_by(cancer_abbrev) |>
summarise(total_mutations = sum(as.numeric(Mutation.Count)))
View(STMN2_cryptic_cBio)
View(cBio_clinical)
total_mutations_each_cancer <- cBio_clinical |>
drop_na(Mutation.Count) |>
filter(grepl("^\\d+$", Mutation.Count)) |>
group_by(cancer_abbrev) |>
summarise(total_mutations = sum(as.numeric(Mutation.Count)))
total_mutations_each_cancer_with_cryptic <- STMN2_cryptic_cBio |>
drop_na(mutation_count) |>
filter(mutation_count < 2500) |>
group_by(cancer_abbrev) |>
summarise(total_mutations_cryptic = sum(mutation_count))
mutations_each_cancer_general_vs_cryptic <- total_mutations_each_cancer |>
left_join(total_mutations_each_cancer_with_cryptic, by=c("cancer_abbrev")) |>
mutate(percent_with_cryptic = (total_mutations_cryptic/total_mutations)*100)
View(mutations_each_cancer_general_vs_cryptic)
mutations_each_cancer_general_vs_cryptic <- mutations_each_cancer_general_vs_cryptic |>
mutate(total_cancer_abbrev = total_each_cancer_general_vs_cryptic$total_cancer_abbrev) |>
mutate(total_cancer_abbrev_with_cryptic = total_each_cancer_general_vs_cryptic$total_cancer_abbrev_with_cryptic) |>
mutate(avg_mutation_per_case = total_mutations/total_cancer_abbrev) |>
mutate(avg_mutation_per_case_cryptic = total_mutations_cryptic/total_cancer_abbrev_with_cryptic) |>
select(-total_cancer_abbrev, -total_cancer_abbrev_with_cryptic)
total_each_cancer <- cBio_clinical |>
group_by(cancer_abbrev) |>
summarise(total_cancer_abbrev = n())
total_each_cancer_with_cryptic <- STMN2_cryptic_cBio |>
group_by(cancer_abbrev) |>
summarise(total_cancer_abbrev_with_cryptic = n())
total_each_cancer_general_vs_cryptic <- total_each_cancer |>
left_join(total_each_cancer_with_cryptic, by=c("cancer_abbrev")) |>
mutate(percent_with_cryptic = (total_cancer_abbrev_with_cryptic/total_cancer_abbrev)*100)
mutations_each_cancer_general_vs_cryptic <- mutations_each_cancer_general_vs_cryptic |>
mutate(total_cancer_abbrev = total_each_cancer_general_vs_cryptic$total_cancer_abbrev) |>
mutate(total_cancer_abbrev_with_cryptic = total_each_cancer_general_vs_cryptic$total_cancer_abbrev_with_cryptic) |>
mutate(avg_mutation_per_case = total_mutations/total_cancer_abbrev) |>
mutate(avg_mutation_per_case_cryptic = total_mutations_cryptic/total_cancer_abbrev_with_cryptic) |>
select(-total_cancer_abbrev, -total_cancer_abbrev_with_cryptic)
mutations_each_cancer_general_vs_cryptic |>
drop_na() |>
ggplot(aes(x = cancer_abbrev)) +
geom_bar(aes(y = avg_mutation_per_case, fill = "avg_mutation_per_case"), stat = "identity", position = "dodge") +
geom_bar(aes(y = avg_mutation_per_case_cryptic, fill = "avg_mutation_per_case_cryptic"), stat = "identity", position = "dodge") +
labs(
x = "Cancer Type",
y = "Average number of mutations per case",
fill = ""
) +
scale_fill_manual(values = c("avg_mutation_per_case" = "violetred4", "avg_mutation_per_case_cryptic" = "royalblue1"),
labels = c("All Cases", "STMN2 Cryptic Cases only"))
mutations_each_cancer_general_vs_cryptic |>
drop_na() |>
ggplot(aes(x = reorder(cancer_abbrev, -avg_mutation_per_case))) +
geom_bar(aes(y = avg_mutation_per_case, fill = "avg_mutation_per_case"), stat = "identity", position = "dodge") +
geom_bar(aes(y = avg_mutation_per_case_cryptic, fill = "avg_mutation_per_case_cryptic"), stat = "identity", position = "dodge") +
labs(
x = "Cancer Type",
y = "Average number of mutations per case",
fill = ""
) +
scale_fill_manual(values = c("avg_mutation_per_case" = "violetred4", "avg_mutation_per_case_cryptic" = "royalblue1"),
labels = c("All Cases", "STMN2 Cryptic Cases only"))
mutations_each_cancer_general_vs_cryptic |>
drop_na() |>
ggplot(aes(x = reorder(cancer_abbrev, -avg_mutation_per_case_cryptic))) +
geom_bar(aes(y = avg_mutation_per_case, fill = "avg_mutation_per_case"), stat = "identity", position = "dodge") +
geom_bar(aes(y = avg_mutation_per_case_cryptic, fill = "avg_mutation_per_case_cryptic"), stat = "identity", position = "dodge") +
labs(
x = "Cancer Type",
y = "Average number of mutations per case",
fill = ""
) +
scale_fill_manual(values = c("avg_mutation_per_case" = "violetred4", "avg_mutation_per_case_cryptic" = "royalblue1"),
labels = c("All Cases", "STMN2 Cryptic Cases only"))
mutations_each_cancer_general_vs_cryptic |>
drop_na() |>
ggplot(aes(x = reorder(cancer_abbrev, avg_mutation_per_case_cryptic))) +
geom_bar(aes(y = avg_mutation_per_case, fill = "avg_mutation_per_case"), stat = "identity", position = "dodge") +
geom_bar(aes(y = avg_mutation_per_case_cryptic, fill = "avg_mutation_per_case_cryptic"), stat = "identity", position = "dodge") +
labs(
x = "Cancer Type",
y = "Average number of mutations per case",
fill = ""
) +
scale_fill_manual(values = c("avg_mutation_per_case" = "violetred4", "avg_mutation_per_case_cryptic" = "royalblue1"),
labels = c("All Cases", "STMN2 Cryptic Cases only"))
View(STMN2_cryptic_cBio)
View(SYNJ2_cryptic_cBio)
View(ARHGAP32_cryptic_cBio)
View(STMN2_cryptic_rawcounts_psi)
STMN2_ARHGAP32_SYNJ2_cryptic <- STMN2_cryptic_cBio |>
inner_join(ARHGAP32_cryptic_cBio, by="case_submitter_id") |>
inner_join(SYNJ2_cryptic_cBio, by="case_submitter_id")
View(STMN2_ARHGAP32_SYNJ2_cryptic)
STMN2_ARHGAP32_SYNJ2_cryptic <- STMN2_cryptic_cBio |>
left_join(ARHGAP32_cryptic_cBio, by="case_submitter_id") |>
left_join(SYNJ2_cryptic_cBio, by="case_submitter_id")
STMN2_ARHGAP32_SYNJ2_cryptic <- STMN2_cryptic_cBio |>
left_join(ARHGAP32_cryptic_cBio, by="case_submitter_id") |>
left_join(SYNJ2_cryptic_cBio, by="case_submitter_id") |>
janitor::clean_names()
View(STMN2_clinical_jir_cryptic)
STMN2_cryptic_cBio <- STMN2_clinical_jir_cryptic |>
left_join(cBio_clinical_2, by = "case_submitter_id") |>
distinct()
View(STMN2_cryptic_cBio)
STMN2_cryptic_cBio <- STMN2_cryptic_cBio |>
select(c(STMN2_cryptic_coverage, STMN2_annotated_coverage, jir, case_submitter_id, cancer_type, gdc_primary_site,
junction_coverage, junction_avg_coverage, rpm, Months.of.disease.specific.survival, Mutation.Count)) |>
rename("STMN2_jir" = "jir") |>
rename("STMN2_junction_coverage" = "junction_coverage") |>
rename("STMN2_junction_avg_coverage" = "junction_avg_coverage") |>
rename("STMN2_rpm" = "rpm") |>
rename("STMN2_months_survival" = "Months.of.disease.specific.survival") |>
rename("STMN2_mutation_count" = "Mutation.Count")
ARHGAP32_cryptic_cBio <- ARHGAP32_cryptic_cBio |>
select(c(cryptic_count, anno_count, jir, case_submitter_id, junction_coverage, junction_avg_coverage, cancer_abbrev,
disease_survival_months, mutation_count)) |>
rename("ARHGAP32_cryptic_count" = "cryptic_count") |>
rename("ARHGAP32_anno_count" = "anno_count") |>
rename("ARHGAP32_jir" = "jir") |>
rename("ARHGAP32_junction_coverage" = "junction_coverage") |>
rename("ARHGAP32_junction_avg_coverage" = "junction_avg_coverage") |>
rename("ARHGAP32_months_survival" = "disease_survival_months") |>
rename("ARHGAP32_mutation_count" = "mutation_count")
SYNJ2_cryptic_cBio <- SYNJ2_cryptic_cBio |>
select(c(cryptic_count, anno_count, jir, junction_coverage, junction_avg_coverage, case_submitter_id,
disease_survival_months, mutation_count)) |>
rename("SYNJ2_cryptic_count" = "cryptic_count") |>
rename("SYNJ2_anno_count" = "anno_count") |>
rename("SYNJ2_jir" = "jir") |>
rename("SYNJ2_junction_coverage" = "junction_coverage") |>
rename("SYNJ2_junction_avg_coverage" = "junction_avg_coverage") |>
rename("SYNJ2_months_survival" = "disease_survival_months") |>
rename("SYNJ2_mutation_count" = "mutation_count")
STMN2_ARHGAP32_SYNJ2_cryptic <- STMN2_cryptic_cBio |>
left_join(ARHGAP32_cryptic_cBio, by="case_submitter_id") |>
left_join(SYNJ2_cryptic_cBio, by="case_submitter_id")
View(STMN2_ARHGAP32_SYNJ2_cryptic)
STMN2_ARHGAP32_SYNJ2_cryptic <- STMN2_cryptic_cBio |>
inner_join(ARHGAP32_cryptic_cBio, by="case_submitter_id")
STMN2_ARHGAP32_SYNJ2_cryptic <- STMN2_cryptic_cBio |>
inner_join(SYNJ2_cryptic_cBio, by="case_submitter_id")
STMN2_cryptic_cBio <- STMN2_cryptic_cBio |>
select(c(STMN2_cryptic_coverage, STMN2_annotated_coverage, jir, case_submitter_id, cancer_type, gdc_primary_site,
junction_coverage, junction_avg_coverage, rpm, Months.of.disease.specific.survival, Mutation.Count)) |>
rename("STMN2_jir" = "jir") |>
rename("STMN2_junction_coverage" = "junction_coverage") |>
rename("STMN2_junction_avg_coverage" = "junction_avg_coverage") |>
rename("STMN2_rpm" = "rpm") |>
rename("STMN2_months_survival" = "Months.of.disease.specific.survival") |>
rename("STMN2_mutation_count" = "Mutation.Count") |>
distinct()
SYNJ2_cryptic_cBio <- SYNJ2_cryptic_cBio |>
select(c(cryptic_count, anno_count, jir, junction_coverage, junction_avg_coverage, case_submitter_id,
disease_survival_months, mutation_count)) |>
rename("SYNJ2_cryptic_count" = "cryptic_count") |>
rename("SYNJ2_anno_count" = "anno_count") |>
rename("SYNJ2_jir" = "jir") |>
rename("SYNJ2_junction_coverage" = "junction_coverage") |>
rename("SYNJ2_junction_avg_coverage" = "junction_avg_coverage") |>
rename("SYNJ2_months_survival" = "disease_survival_months") |>
rename("SYNJ2_mutation_count" = "mutation_count") |>
distinct()
STMN2_cryptic_cBio<- STMN2_cryptic_cBio |> distinct()
ARHGAP32_cryptic_cBio<- ARHGAP32_cryptic_cBio |> distinct()
SYNJ2_cryptic_cBio<- SYNJ2_cryptic_cBio |> distinct()
STMN2_ARHGAP32_SYNJ2_cryptic <- STMN2_cryptic_cBio |>
inner_join(SYNJ2_cryptic_cBio, by="case_submitter_id") |>
inner_join(ARHGAP32_cryptic_cBio, by="case_submitter_id")
cBio_clinical_2 |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id" = "gdc_cases.submitter_id"))
cBio_clinical_2 |>
left_join(STMN2_clinical_jir,by = c("gdc_cases.submitter_id"))
cBio_clinical_2 |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id"))
View(cBio_clinical_2)
STTMN2_clinical_jir_cryptic |>
left_join(cBio_clinical_2)
View(STMN2_clinical_jir_cryptic)
STMN2_clinical_jir_cryptic |>
left_join(cBio_clinical_2)
cBio_clinical_2 |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id" = "gdc_cases.submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage)
cBio_clinical_2 |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage)
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage)
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique()
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |> mutate(Mutation.Count = as.numeric(Mutation.Count))
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |> mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA")
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |> mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2)
TRUE+TRUE+FALSE
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |> mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2) |>
group_by(study_start)
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |> mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2) |>
group_by(study_start) |>
mutate(n_total_samples = n_distinct(case_submitter_id))
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |> mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2) |>
group_by(study_start) |>
mutate(n_total_samples = n_distinct(case_submitter_id)) |>
mutate(n_detected_stmn2 = sum(stmn2_cryptic_detected,na.rm = TRUE))
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |>
mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2) |>
group_by(study_start) |>
mutate(n_total_samples = n_distinct(case_submitter_id)) |>
mutate(n_detected_stmn2 = sum(stmn2_cryptic_detected,na.rm = TRUE)) |>
ungroup()
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |>
mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2) |>
group_by(study_start) |>
mutate(n_total_samples = n_distinct(case_submitter_id)) |>
mutate(n_detected_stmn2 = sum(stmn2_cryptic_detected,na.rm = TRUE)) |>
ungroup() |>
filter(!is.na(stmn2_cryptic_detected))
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |>
mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2) |>
group_by(study_start) |>
mutate(n_total_samples = n_distinct(case_submitter_id)) |>
mutate(n_detected_stmn2 = sum(stmn2_cryptic_detected,na.rm = TRUE)) |>
ungroup() |>
filter(!is.na(stmn2_cryptic_detected)) |>
filter(n_detected_stmn2 > 2)
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |>
mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2) |>
group_by(study_start) |>
mutate(n_total_samples = n_distinct(case_submitter_id)) |>
mutate(n_detected_stmn2 = sum(stmn2_cryptic_detected,na.rm = TRUE)) |>
ungroup() |>
filter(!is.na(stmn2_cryptic_detected)) |>
filter(n_detected_stmn2 > 2) |>
ggplot(aes(x = study_start,
y = Mutation.Count)) +
geom_boxplot(aes(fill = stmn2_cryptic_detected)) +
coord_flip() +
scale_y_continuous(trans = scales::pseudo_log_trans())
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |>
mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2) |>
group_by(study_start) |>
mutate(n_total_samples = n_distinct(case_submitter_id)) |>
mutate(n_detected_stmn2 = sum(stmn2_cryptic_detected,na.rm = TRUE)) |>
ungroup() |>
filter(!is.na(stmn2_cryptic_detected)) |>
filter(n_detected_stmn2 > 2) |>
ggplot(aes(x = study_start,
y = Mutation.Count)) +
geom_boxplot(aes(fill = stmn2_cryptic_detected)) +
coord_flip()
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |>
mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2) |>
group_by(study_start) |>
mutate(n_total_samples = n_distinct(case_submitter_id)) |>
mutate(n_detected_stmn2 = sum(stmn2_cryptic_detected,na.rm = TRUE)) |>
ungroup() |>
filter(!is.na(stmn2_cryptic_detected)) |>
filter(n_detected_stmn2 > 2) |>
ggplot(aes(x = study_start,
y = Mutation.Count)) +
geom_boxplot(aes(fill = stmn2_cryptic_detected)) +
coord_flip() +
scale_y_continuous(trans = scales::pseudo_log_trans())
cBio_clinical |> mutate(Mutation.Count = as.numeric(Mutation.Count)) |> ggplot(aes(x=Mutation.Count)) + geom_histogram()
cBio_clinical |> mutate(Mutation.Count = as.numeric(Mutation.Count)) |> ggplot(aes(x=Mutation.Count)) + geom_histogram() + scale_x_continuous(trans=scales::pseudo_log_trans())
library(tidyverse)
library(repurrrsive)
library(jsonlite)
library(clipr)
library(naniar)
library(ggpubr)
library(rstatix)
library(ggplot2)
library(tidyr)
library(dplyr)
library(knitr)
library(snapcount)
library(ggsignif)
library(TCGAbiolinks)
mutations_each_cancer_general_vs_cryptic |>
drop_na() |>
ggplot(aes(x = reorder(cancer_abbrev, avg_mutation_per_case_cryptic))) +
geom_bar(aes(y = avg_mutation_per_case, fill = "avg_mutation_per_case"), stat = "identity", position = "dodge") +
geom_bar(aes(y = avg_mutation_per_case_cryptic, fill = "avg_mutation_per_case_cryptic"), stat = "identity", position = "dodge") +
labs(
x = "Cancer Type",
y = "Average number of mutations per case",
fill = ""
) +
scale_fill_manual(values = c("avg_mutation_per_case" = "violetred4", "avg_mutation_per_case_cryptic" = "royalblue1"),
labels = c("All Cases", "STMN2 Cryptic Cases only"))
View(mutations_each_cancer_general_vs_cryptic)
scale_y_continuous(trans = scales::pseudo_log_trans())
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |>
mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2) |>
group_by(study_start) |>
mutate(n_total_samples = n_distinct(case_submitter_id)) |>
mutate(n_detected_stmn2 = sum(stmn2_cryptic_detected,na.rm = TRUE)) |>
ungroup() |>
filter(!is.na(stmn2_cryptic_detected)) |>
filter(n_detected_stmn2 > 2) |>
ggplot(aes(x = study_start,
y = Mutation.Count)) +
geom_boxplot(aes(fill = stmn2_cryptic_detected)) +
coord_flip() +
scale_y_continuous(trans = scales::pseudo_log_trans())
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |>
mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2) |>
group_by(study_start) |>
mutate(n_total_samples = n_distinct(case_submitter_id)) |>
mutate(n_detected_stmn2 = sum(stmn2_cryptic_detected,na.rm = TRUE)) |>
ungroup() |>
filter(!is.na(stmn2_cryptic_detected)) |>
filter(n_detected_stmn2 > 2) |>
ggplot(aes(x = study_start,
y = Mutation.Count)) +
geom_boxplot(aes(fill = stmn2_cryptic_detected)) +
labs(x = "Mutation Count",
y = "Cancer Type",
stmn2_cryptic_detected = "Has STMN2 cryptic events") +
coord_flip() +
scale_y_continuous(trans = scales::pseudo_log_trans())
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |>
mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2) |>
group_by(study_start) |>
mutate(n_total_samples = n_distinct(case_submitter_id)) |>
mutate(n_detected_stmn2 = sum(stmn2_cryptic_detected,na.rm = TRUE)) |>
ungroup() |>
filter(!is.na(stmn2_cryptic_detected)) |>
filter(n_detected_stmn2 > 2) |>
ggplot(aes(x = study_start,
y = Mutation.Count)) +
geom_boxplot(aes(fill = stmn2_cryptic_detected)) +
labs(x = "Cancer Type",
y = "Mutation Count",
stmn2_cryptic_detected = "Has STMN2 cryptic events") +
coord_flip() +
scale_y_continuous(trans = scales::pseudo_log_trans())
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |>
mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2) |>
group_by(study_start) |>
mutate(n_total_samples = n_distinct(case_submitter_id)) |>
mutate(n_detected_stmn2 = sum(stmn2_cryptic_detected,na.rm = TRUE)) |>
ungroup() |>
filter(!is.na(stmn2_cryptic_detected)) |>
filter(n_detected_stmn2 > 2) |>
ggplot(aes(x = study_start,
y = Mutation.Count)) +
geom_boxplot(aes(fill = stmn2_cryptic_detected)) +
labs(x = "Cancer Type",
y = "Mutation Count",
"stmn2_cryptic_detected" = "Has STMN2 cryptic events") +
coord_flip() +
scale_y_continuous(trans = scales::pseudo_log_trans())
cBio_clinical |>
left_join(STMN2_clinical_jir,by = c("case_submitter_id")) |>
select('case_submitter_id',Study.ID,cancer_abbrev,Mutation.Count,STMN2_cryptic_coverage,STMN2_annotated_coverage) |>
separate(Study.ID,into = ('study_start'),remove = FALSE) |>
unique() |>
mutate(Mutation.Count = as.numeric(Mutation.Count)) |>
filter(!is.na(Mutation.Count) & Mutation.Count != "NA") |>
mutate(stmn2_cryptic_detected = STMN2_cryptic_coverage >= 2) |>
group_by(study_start) |>
mutate(n_total_samples = n_distinct(case_submitter_id)) |>
mutate(n_detected_stmn2 = sum(stmn2_cryptic_detected,na.rm = TRUE)) |>
ungroup() |>
filter(!is.na(stmn2_cryptic_detected)) |>
filter(n_detected_stmn2 > 2) |>
ggplot(aes(x = study_start,
y = Mutation.Count)) +
geom_boxplot(aes(fill = stmn2_cryptic_detected)) +
labs(x = "Cancer Type",
y = "Mutation Count") +
coord_flip() +
scale_y_continuous(trans = scales::pseudo_log_trans())
mutations_each_cancer_general_vs_cryptic |>
drop_na() |>
ggplot(aes(x = reorder(cancer_abbrev, avg_mutation_per_case_cryptic))) +
geom_bar(aes(y = avg_mutation_per_case, fill = "avg_mutation_per_case"), stat = "identity", position = "dodge") +
geom_bar(aes(y = avg_mutation_per_case_cryptic, fill = "avg_mutation_per_case_cryptic"), stat = "identity", position = "dodge") +
labs(
x = "Cancer Type",
y = "Average number of mutations per case",
fill = ""
) +
scale_fill_manual(values = c("avg_mutation_per_case" = "violetred4", "avg_mutation_per_case_cryptic" = "royalblue1"),
labels = c("All Cases", "STMN2 Cryptic Cases only"))
