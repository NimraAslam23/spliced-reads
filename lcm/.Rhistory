rename("mutations" = "X..Mutations")
# unique simple somatic mutations in the gene in cohort
# Chunk 7: Import mutation data from TCGA
STMN2_events_mutations_orig <- read.csv("STMN2_events_mutations.tsv", sep = "\t", header = TRUE, na.strings = "", fill = TRUE)
head(STMN2_events_mutations_orig)
STMN2_events_mutations <- STMN2_events_mutations_orig
# Chunk 8: Import clinical data from TCGA
STMN2_clinical_orig <- read.csv("STMN2_clinical.tsv", sep = "\t", header = TRUE, na.strings = "", fill = TRUE)
head(STMN2_clinical_orig)
STMN2_clinical <- STMN2_clinical_orig
STMN2_clinical <- STMN2_clinical|>
select(case_submitter_id, project_id, age_at_index, ethnicity, gender, race, ajcc_pathologic_stage) |>
separate(project_id, into = c("project", "cancer_type")) |>
select(-project)
# Chunk 9: bar plot - cancer types with cryptic STMN2 events
STMN2_clinical |>
ggplot(aes(x = fct_rev(fct_infreq(cancer_type)))) +
geom_bar(aes(fill = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
y = "Number of Cases",
title = "STMN2 cryptic events are found in mostly breast and brain cancers"
) +
theme(legend.position = "none")
# Chunk 10: joining jir table with clinical table
jir_new <- jir_new |>
rename("case_submitter_id" = "gdc_cases.submitter_id")
STMN2_clinical_jir <- jir_new |>
left_join(STMN2_clinical, by=c("case_submitter_id"))
STMN2_clinical_jir <- STMN2_clinical_jir |>
select(-gdc_cases.diagnoses.tumor_stage, -age_at_index, -gdc_cases.demographic.gender,
-ajcc_pathologic_stage, -ethnicity, -race, -cancer_type, -gender)
STMN2_clinical_jir <- STMN2_clinical_jir |>
rename("cancer_type" = "gdc_cases.project.name") |>
rename("gdc_primary_site" = "gdc_cases.project.primary_site") |>
rename("sample_type" = "gdc_cases.samples.sample_type") |>
rename("cgc_primary_site" = "cgc_case_primary_site")
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(cgc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = cgc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none")
STMN2_events_different_cancers <- STMN2_clinical_jir_cryptic |>
drop_na() |>
janitor::tabyl(cancer_type) |> arrange(-percent)
kable(STMN2_events_different_cancers,
caption = "Cryptic STMN2 events are found primarily in breast and brain cancer.")
STMN2_events_primary_sites1 <- STMN2_clinical_jir_cryptic |>
drop_na() |>
janitor::tabyl(gdc_primary_site) |> arrange(-percent)
kable(STMN2_events_primary_sites1, caption = ".")
STMN2_events_primary_sites2 <- STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
janitor::tabyl(cgc_primary_site) |> arrange(-percent)
kable(STMN2_events_primary_sites2, caption = ".")
STMN2_events_primary_sites1 <- STMN2_clinical_jir_cryptic |>
drop_na() |>
janitor::tabyl(gdc_primary_site) |> arrange(-percent)
kable(STMN2_events_primary_sites1, caption = ".")
stat.test <- STMN2_clinical_jir_cryptic |> t_test(gdc_primary_site ~ junction_avg_coverage, ref.group = "all")
stat.test <- STMN2_clinical_jir_cryptic |> wilcox.test(gdc_primary_site ~ junction_avg_coverage, ref.group = "all")
View(STMN2_clinical_jir)
STMN2_clinical_jir_cryptic |> as.numeric(junction_avg_coverage)
STMN2_clinical_jir_cryptic <- as.numeric(STMN2_clinical_jir_cryptic$junction_avg_coverage)
stat.test <- STMN2_clinical_jir_cryptic |> wilcox.test(gdc_primary_site ~ junction_avg_coverage, ref.group = "all")
stat.test <- STMN2_clinical_jir_cryptic |> t_test(gdc_primary_site ~ junction_avg_coverage, ref.group = "all")
stat.test <- STMN2_clinical_jir_cryptic |> t_test(gdc_primary_site ~ junction_avg_coverage)
STMN2_clinical_jir_cryptic <- as.character(STMN2_clinical_jir_cryptic$gdc_primary_site)
STMN2_clinical_jir_cryptic <- as.numeric(STMN2_clinical_jir_cryptic$junction_avg_coverage)
STMN2_clinical_jir_cryptic <- as.numeric(STMN2_clinical_jir_cryptic$junction_avg_coverage)
STMN2_clinical_jir_cryptic <- STMN2_clinical_jir |>
filter(STMN2_cryptic_coverage > 2)
STMN2_clinical_jir_cryptic <- STMN2_clinical_jir |>
filter(STMN2_cryptic_coverage > 2) |>
as.numeric(junction_avg_coverage) |>
as.character(gdc_primary_site)
head(STMN2_clinical_jir_cryptic)
STMN2_clinical_jir_cryptic <- STMN2_clinical_jir |>
filter(STMN2_cryptic_coverage > 2) |>
as.numeric(junction_avg_coverage) |>
as.character(gdc_primary_site)
STMN2_clinical_jir_cryptic <- STMN2_clinical_jir |>
filter(STMN2_cryptic_coverage > 2) |>
as.character(gdc_primary_site) |>  as.numeric(junction_avg_coverage)
STMN2_clinical_jir_cryptic <- STMN2_clinical_jir |>
filter(STMN2_cryptic_coverage > 2)
transform(STMN2_clinical_jir_cryptic, gdc_primary_site = as.character(gdc_primary_site),
junction_avg_coverage = as.numeric(junction_avg_coverage))
stat.test <- STMN2_clinical_jir_cryptic |> t_test(gdc_primary_site ~ junction_avg_coverage)
View(STMN2_clinical_jir_cryptic)
stat.test <- STMN2_clinical_jir_cryptic |> wilcox.test(gdc_primary_site ~ junction_avg_coverage)
transform(STMN2_clinical_jir_cryptic, gdc_primary_site = as.character(gdc_primary_site),
junction_avg_coverage = as.numeric(junction_avg_coverage))
stat.test <- STMN2_clinical_jir_cryptic |> wilcox.test(gdc_primary_site ~ junction_avg_coverage)
stat.test <- STMN2_clinical_jir_cryptic |> wilcox.test(junction_avg_coverage ~ gdc_primary_site)
stat.test <- STMN2_clinical_jir_cryptic |> wilcox.test(as.numeric(junction_avg_coverage) ~ gdc_primary_site)
stat.test <- STMN2_clinical_jir_cryptic |> wilcox.test(as.numeric(junction_avg_coverage) ~ gdc_primary_site)
wilcox.test(junction_avg_coverage ~ gdc_primary_site, data = STMN2_clinical_jir_cryptic)
t_test(junction_avg_coverage ~ gdc_primary_site, data = STMN2_clinical_jir_cryptic)
wilcox_test(junction_avg_coverage ~ gdc_primary_site, data = STMN2_clinical_jir_cryptic)
stat.test <- STMN2_clinical_jir_cryptic |> t_test(junction_avg_coverage ~ gdc_primary_site)
stat.test <- STMN2_clinical_jir_cryptic |> wilcox.test(junction_avg_coverage ~ gdc_primary_site)
stat.test <- STMN2_clinical_jir_cryptic |> wilcox_test(junction_avg_coverage ~ gdc_primary_site)
rlang::last_error()
stat.test <- STMN2_clinical_jir_cryptic |> wilcox.test.default(junction_avg_coverage ~ gdc_primary_site)
stat.test <- STMN2_clinical_jir_cryptic |> wilcox.test(junction_avg_coverage ~ gdc_primary_site)
stat.test <- STMN2_clinical_jir_cryptic |> t_test(junction_avg_coverage ~ gdc_primary_site)
install.packages("ggsignif")
library("ggsignif")
library(ggsignif)
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast")))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(repurrrsive)
library(jsonlite)
library(clipr)
library(naniar)
library(ggpubr)
library(rstatix)
library(ggplot2)
library(tidyr)
library(dplyr)
library(knitr)
library(snapcount)
library(ggsignif)
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast")))
STMN2_clinical_jir_cryptic |>
drop_na() |>
ggplot(aes(x = fct_rev(fct_infreq(gdc_primary_site)))) +
geom_bar(aes(fill = gdc_primary_site)) +
coord_flip() +
labs(
x = "Primary Site of Cancer",
y = "Number of Cases",
title = "Primary sites of cancers with cryptic STMN2 events are mostly the adrenal gland and brain"
) +
theme(legend.position = "none", plot.title = element_text(size=9))
STMN2_clinical_jir_cryptic |>
drop_na() |>
ggplot(aes(x = fct_rev(fct_infreq(gdc_primary_site)))) +
geom_bar(aes(fill = gdc_primary_site)) +
coord_flip() +
labs(
x = "Primary Site of Cancer",
y = "Number of Cases",
title = "Primary sites of cancers with cryptic STMN2 events are mostly the adrenal gland and brain"
) +
theme(legend.position = "none", plot.title = element_text(size=9)) +
geom_signif(comparisons = list(c("Adrenal Gland", "Brain")))
rlang::last_error()
STMN2_clinical_jir_cryptic |>
drop_na() |>
ggplot(aes(x = fct_rev(fct_infreq(gdc_primary_site)))) +
geom_bar(aes(fill = gdc_primary_site)) +
coord_flip() +
labs(
x = "Primary Site of Cancer",
y = "Number of Cases",
title = "Primary sites of cancers with cryptic STMN2 events are mostly the adrenal gland and brain"
) +
theme(legend.position = "none", plot.title = element_text(size=9))
STMN2_clinical_jir_cryptic |>
drop_na() |>
ggplot(aes(x = fct_rev(fct_infreq(gdc_primary_site)))) +
geom_bar(aes(fill = gdc_primary_site)) +
coord_flip() +
labs(
x = "Primary Site of Cancer",
y = "Number of Cases",
title = "Primary sites of cancers with cryptic STMN2 events are mostly the adrenal gland and brain"
) +
theme(legend.position = "none", plot.title = element_text(size=9)) +
geom_signif(comparisons = list(c("Adrenal Gland", "Brain")))
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast")))
STMN2_clinical_jir_cryptic |>
drop_na() |>
ggplot(aes(x = fct_rev(fct_infreq(gdc_primary_site)))) +
geom_bar(aes(fill = gdc_primary_site)) +
coord_flip() +
labs(
x = "Primary Site of Cancer",
y = "Number of Cases",
title = "Primary sites of cancers with cryptic STMN2 events are mostly the adrenal gland and brain"
) +
theme(legend.position = "none", plot.title = element_text(size=9)) +
geom_signif(comparisons = list(c("Testes", "Brain")))
STMN2_clinical |>
ggplot(aes(x = fct_rev(fct_infreq(cancer_type)))) +
geom_bar(aes(fill = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
y = "Number of Cases",
title = "STMN2 events are found in mostly breast and brain cancers"
) +
theme(legend.position = "none", plot.title = element_text(size=10))
STMN2_clinical |>
ggplot(aes(x = fct_rev(fct_infreq(cancer_type)))) +
geom_bar(aes(fill = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
y = "Number of Cases",
title = "STMN2 events are found in mostly breast and brain cancers"
) +
theme(legend.position = "none", plot.title = element_text(size=10))+
geom_signif(comparisons = list(c("BRCA", "LGG")))
STMN2_clinical |>
ggplot(aes(x = fct_rev(fct_infreq(cancer_type)))) +
geom_bar(aes(fill = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
y = "Number of Cases",
title = "STMN2 events are found in mostly breast and brain cancers"
) +
theme(legend.position = "none", plot.title = element_text(size=10))
STMN2_clinical |>
ggplot(aes(x = fct_rev(fct_infreq(cancer_type)), y = count)) +
geom_bar(aes(fill = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
y = "Number of Cases",
title = "STMN2 events are found in mostly breast and brain cancers"
) +
theme(legend.position = "none", plot.title = element_text(size=10))
STMN2_clinical |>
ggplot(aes(x = fct_rev(fct_infreq(cancer_type)))) +
geom_bar(aes(fill = cancer_type, y = count)) +
coord_flip() +
labs(
x = "Cancer Type",
y = "Number of Cases",
title = "STMN2 events are found in mostly breast and brain cancers"
) +
theme(legend.position = "none", plot.title = element_text(size=10))
STMN2_clinical |>
ggplot(aes(x = fct_rev(fct_infreq(cancer_type)))) +
geom_bar(aes(fill = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
y = "Number of Cases",
title = "STMN2 events are found in mostly breast and brain cancers"
) +
theme(legend.position = "none", plot.title = element_text(size=10))
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast")))
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast", "Brain")))
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast")),
map_signif_level = TRUE)
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast"), c("Stomach", "Brain")),
map_signif_level = TRUE)
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast"), c("Stomach", "Brain")),
map_signif_level = TRUE,
y_position = c(7.5, 9)))
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast"), c("Stomach", "Brain")),
map_signif_level = TRUE,
y_position = c(7.5, 9))
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast"), c("Stomach", "Brain")),
map_signif_level = TRUE,
y_position = c(20, 9))
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast"), c("Stomach", "Brain")),
map_signif_level = TRUE,
y_position = c(100, 9))
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast"), c("Stomach", "Brain")),
map_signif_level = TRUE,
y_position = c(70, 9))
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast"), c("Stomach", "Brain")),
map_signif_level = TRUE,
y_position = c(80, 9))
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast"), c("Stomach", "Brain")),
map_signif_level = TRUE,
y_position = c(75, 90))
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast"), c("Stomach", "Brain")),
map_signif_level = TRUE,
y_position = c(75, 80))
STMN2_clinical_jir_cryptic |>
drop_na() |>
ggplot(aes(x = fct_rev(fct_infreq(gdc_primary_site)))) +
geom_bar(aes(fill = gdc_primary_site)) +
coord_flip() +
labs(
x = "Primary Site of Cancer",
y = "Number of Cases",
title = "Primary sites of cancers with cryptic STMN2 events are mostly the adrenal gland and brain"
) +
theme(legend.position = "none", plot.title = element_text(size=9)) +
geom_signif(comparisons = list(c("Adrenal Gland", "Brain")),
map_signif_level = TRUE)
STMN2_clinical |>
ggplot(aes(x = fct_rev(fct_infreq(cancer_type)))) +
geom_bar(aes(fill = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
y = "Number of Cases",
title = "STMN2 events are found in mostly breast and brain cancers"
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Adrenal Gland", "Brain")),
map_signif_level = TRUE)
STMN2_clinical |>
ggplot(aes(x = fct_rev(fct_infreq(cancer_type)))) +
geom_bar(aes(fill = cancer_type)) +
coord_flip() +
labs(
x = "Cancer Type",
y = "Number of Cases",
title = "STMN2 events are found in mostly breast and brain cancers"
) +
theme(legend.position = "none", plot.title = element_text(size=10))
STMN2_clinical_jir_cryptic |>
drop_na() |>
ggplot(aes(x = fct_rev(fct_infreq(gdc_primary_site)))) +
geom_bar(aes(fill = gdc_primary_site)) +
coord_flip() +
labs(
x = "Primary Site of Cancer",
y = "Number of Cases",
title = "Primary sites of cancers with cryptic STMN2 events are mostly the adrenal gland and brain"
) +
theme(legend.position = "none", plot.title = element_text(size=9))
STMN2_clinical_jir_cryptic |>
drop_na() |>
filter(cgc_primary_site != "") |>
ggplot(aes(x = junction_avg_coverage, y = fct_reorder(gdc_primary_site,
junction_avg_coverage, median))) +
geom_boxplot(aes(fill = gdc_primary_site)) +
labs(
x = "Junction Average Coverage",
y = "Primary Site of Cancer",
) +
theme(legend.position = "none", plot.title = element_text(size=10)) +
geom_signif(comparisons = list(c("Stomach", "Breast"), c("Stomach", "Brain")),
map_signif_level = TRUE,
y_position = c(75, 80))
View(mutations)
View(bar)
