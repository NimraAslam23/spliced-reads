View(stmn2_all_junctions)
stmn2_all_junctions <- unique(stmn2_all_junctions_orig)
View(stmn2_all_junctions)
View(stmn2_all_junctions_orig)
stmn2_all_junctions$sample_name <- gsub(".SJ.out", "", as.character(stmn2_all_junctions$sample_name))
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp |>
left_join(stmn2_all_junctions, by = "sample_name")
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp |>
left_join(stmn2_all_junctions, by = "sample_name")
library(tidyverse)
library(ggplot2)
library(tidyr)
library(dplyr)
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp |>
left_join(stmn2_all_junctions, by = "sample_name")
View(spliced_reads_pdtp_stmn2)
View(stmn2_all_junctions_orig)
View(spliced_reads_pdtp_stmn2)
View(spliced_reads_pdtp_select)
View(spliced_reads_pdtp)
View(spliced_reads_pdtp)
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp |>
semi_join(stmn2_all_junctions, by=("sample_name"))
View(spliced_reads_pdtp_stmn2)
spliced_reads_pdtp_stmn2 <- stmn2_all_junctions |>
semi_join(spliced_reads_pdtp, by=("sample_name"))
View(spliced_reads_pdtp_stmn2)
View(spliced_reads_pdtp)
View(spliced_reads_pdtp_select)
spliced_reads_pdtp_stmn2 <- stmn2_all_junctions |>
left_join(spliced_reads_pdtp, by=c("sample_name", "chrosome", "start", "end", "n_spliced_reads", "strand"))
View(spliced_reads_pdtp_stmn2)
mean_per_junction |>
semi_join(significant_junctions, by=("junction_name")) |>
mutate(higher_value = ifelse(ALS>control,"ALS","control")) |>
separate(junction_name, sep = '\\|',into = c("gene","junc_cat","n_datasets_junction_found"),convert = TRUE) |>
ggplot(aes(x = junc_cat, fill = higher_value)) +
geom_bar() +
labs(
title = "Number of junctions significantly higher in ALS and controls",
x = "Junction category",
y = "Number of junctions",
color = "Group",
)
View(significant_junctions)
spliced_reads_pdtp_stmn2 |>
mutate(disease = ifelse(grepl("ALS", sample_name),
"ALS",
"control"))
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(disease = ifelse(grepl("ALS", sample_name),
"ALS",
"control"))
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(disease = ifelse(grepl("ALS", sample_name),
"ALS",
"control")) |>
relocate(disease, .after = sample_name)
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(disease = ifelse(grepl("ALS", sample_name),
"ALS",
"Control")) |>
relocate(disease, .after = sample_name)
View(significant_junctions)
View(significant_junctions[[2]][[1]])
spliced_reads_pdtp_stmn2 |>
mutate(higher_value = ifelse(ALS>control, "ALS", "control"))
mean_per_junction |>
semi_join(significant_junctions, by=("junction_name")) |>
mutate(higher_value = ifelse(ALS>control,"ALS","control")) |>
separate(junction_name, sep = '\\|',into = c("gene","junc_cat","n_datasets_junction_found"),convert = TRUE) |>
janitor::tabyl(junc_cat,higher_value)
spliced_reads_pdtp_stmn2 |>
mutate(higher_value = ifelse(ALS>control, "ALS", "control")) |>
separate(junction_name, sep = "\\|", into = c("gene", "junc_cat", "n_datasets_junction_found"), convert = TRUE) |>
janitor::tabyl(junc_cat, higher_value)
View(stmn2_all_junctions_orig)
source("~/Documents/GitHub/spliced-reads/lcm/spliced_read_from_lcm.R", echo=TRUE)
spliced_reads_pdtp_stmn2 |>
group_by(junction_name, disease) |>
mutate(mean_n_spliced_reads = mean(n_spliced_reads)) |>
ungroup() |>
select(junction_name, disease, mean_n_spliced_reads) |>
unique() |>
pivot_wider(names_from = "disease",
values_from = "mean_n_spliced_reads")
spliced_reads_pdtp_stmn2 |>
mutate(higher_value = ifelse(ALS>control, "ALS", "control")) |>
separate(junction_name, sep = "\\|", into = c("gene", "junc_cat", "n_datasets_junction_found"), convert = TRUE) |>
janitor::tabyl(junc_cat, higher_value)
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
group_by(junction_name, disease) |>
mutate(mean_n_spliced_reads = mean(n_spliced_reads)) |>
ungroup() |>
select(junction_name, disease, mean_n_spliced_reads) |>
unique() |>
pivot_wider(names_from = "disease",
values_from = "mean_n_spliced_reads")
spliced_reads_pdtp_stmn2 |>
mutate(higher_value = ifelse(ALS>control, "ALS", "control")) |>
separate(junction_name, sep = "\\|", into = c("gene", "junc_cat", "n_datasets_junction_found"), convert = TRUE) |>
janitor::tabyl(junc_cat, higher_value)
spliced_reads_pdtp_stmn2 |>
mutate(higher_value = ifelse(ALS>Control, "ALS", "Control")) |>
separate(junction_name, sep = "\\|", into = c("gene", "junc_cat", "n_datasets_junction_found"), convert = TRUE) |>
janitor::tabyl(junc_cat, higher_value)
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(disease = ifelse(grepl("ALS", sample_name),
"ALS",
"Control")) |>
relocate(disease, .after = sample_name)
stmn2_all_junctions_orig <- read_tsv("stmn2_all_junctions.bed",
col_names = c("chrosome", "start", "end", "sample_name",
"n_spliced_reads", "strand"))
stmn2_all_junctions <- unique(stmn2_all_junctions_orig)
stmn2_all_junctions$sample_name <- gsub(".SJ.out", "", as.character(stmn2_all_junctions$sample_name))
spliced_reads_pdtp_stmn2 <- stmn2_all_junctions |>
left_join(spliced_reads_pdtp, by=c("sample_name", "chrosome", "start",
"end", "n_spliced_reads", "strand"))
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(disease = ifelse(grepl("ALS", sample_name),
"ALS",
"Control")) |>
relocate(disease, .after = sample_name)
View(spliced_reads_pdtp_stmn2)
spliced_reads_pdtp_stmn2 <- stmn2_all_junctions |>
left_join(pdtp_orig, by=c("sample_name"))
library(tidyverse)
library(ggplot2)
library(tidyr)
library(dplyr)
spliced_reads_pdtp_stmn2 <- stmn2_all_junctions |>
left_join(pdtp_orig, by=c("sample_name"))
spliced_reads_pdtp_stmn2 <- stmn2_all_junctions |>
left_join(ptdp_orig, by=c("sample_name"))
View(spliced_reads_pdtp_stmn2)
View(spliced_reads)
spliced_reads_ptdp_stmn2 <- stmn2_all_junctions |>
left_join(ptdp_orig, by=c("sample_name"))
View(spliced_reads_ptdp_stmn2)
View(M1.BB)
spliced_reads_pdtp_stmn2 |>
filter(grepl("STMN2", junction_name))
View(stmn2_all_junctions_orig)
View(spliced_reads_pdtp_stmn2)
View(stmn2_all_junctions_orig)
View(ptdp_orig)
View(ptdp_orig)
View(spliced_reads_pdtp)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name))
unique(stmn2_all_junctions$end)
stmn2_all_junctions |>
distinct(end)
View(ptdp_orig)
View(spliced_reads)
View(stmn2_all_junctions_orig)
View(spliced_reads_pdtp_stmn2)
View(spliced_reads_pdtp_select)
View(spliced_reads_orig)
View(spliced_reads_pdtp_stmn2)
View(spliced_reads_pdtp_select)
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name))
spliced_reads_pdtp_select |>
filter(grepl("STMN2", junction_name))
spliced_reads_pdtp_stmn2 |>
mutate(junction = ifelse(grepl("79616822", end),
"cryptic",
"annotated"))
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(junction = ifelse(grepl("79616822", end),
"cryptic",
"annotated"))
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(junction = ifelse(grepl("79616822", end),
"cryptic",
"annotated")) |>
relocate(junction, .after = sample_name)
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(junction = ifelse(grepl("79616822", end),
"cryptic",
"annotated")) |>
relocate(junction, .after = sample_name))
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(junction = ifelse(grepl("79616822", end),
"cryptic",
"annotated")) |>
relocate(junction, .after = sample_name)
spliced_reads_pdtp_stmn2 <- spliced_reads_pdtp_stmn2 |>
mutate(junction = ifelse(grepl("79616822", end),
"cryptic",
"annotated")) |>
mutate(disease = ifelse(grepl("ALS", sample_name),
"ALS",
"control")) |>
relocate(disease, .after = sample_name) |>
relocate(junction, .after = disease)
spliced_reads_pdtp_stmn2 |>
filter(grepl("annotated", junction)) |>
drop_na() |>
ggplot(aes(x = disease, y = n_spliced_reads)) |>
geom_boxplot()
spliced_reads_pdtp_stmn2 |>
filter(grepl("annotated", junction)) |>
drop_na() |>
ggplot(aes(x = disease, y = n_spliced_reads)) +
geom_boxplot()
spliced_reads_pdtp_stmn2 |>
filter(grepl("annotated", junction)) |>
ggplot(aes(x = disease, y = n_spliced_reads)) +
geom_boxplot()
spliced_reads_pdtp_stmn2 |>
filter(grepl("annotated", junction)) |>
ggplot(aes(x = disease, y = n_spliced_reads)) +
geom_boxplot() +
labs(
title = "Annotated STMN2 event has higher expression in the control samples",
y = "Number of spliced reads")
spliced_reads_pdtp_stmn2 |>
filter(grepl("annotated", junction)) |>
drop.na() |>
ggplot(aes(x = pTDP_category, y = n_spliced_reads)) +
geom_boxplot()
spliced_reads_pdtp_stmn2 |>
filter(grepl("annotated", junction)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = n_spliced_reads)) +
geom_boxplot()
spliced_reads_pdtp_stmn2 |>
filter(grepl("annotated", junction)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = n_spliced_reads)) +
geom_boxplot() +
labs(
title = "Higher expression of annotated STMN2 event with low levels of pTDP",
x = "Level of phosphorylated TDP-43",
y = "Number of spliced reads")
spliced_reads_pdtp_stmn2 |>
filter(grepl("annotated", junction)) |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = n_spliced_reads)) +
geom_boxplot() +
labs(
title = "Higher expression of annotated STMN2 event with low levels of pTDP",
x = "Level of phosphorylated TDP-43",
y = "Number of spliced reads"
)
spliced_reads_pdtp_stmn2 |>
filter(grepl("annotated", junction)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point()
spliced_reads_pdtp_stmn2 |>
filter(grepl("annotated", junction)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = junction)) +
geom_point()
spliced_reads_pdtp_stmn2 |>
filter(grepl("annotated", junction)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point()
spliced_reads_pdtp_stmn2 |>
filter(grepl("annotated", junction)) |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads)) +
geom_point() +
labs(
x = "Motor neuron death (%)",
y = "Number of spliced reads"
)
spliced_reads_pdtp_stmn2 |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = junction)) +
geom_point() +
labs(
x = "Motor neuron death (%)",
y = "Number of spliced reads"
)
spliced_reads_pdtp_stmn2 |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = junction)) +
geom_point() +
labs(
x = "Motor neuron death (%)",
y = "Number of spliced reads",
color = "Junction"
)
spliced_reads_pdtp_stmn2 |>
ggplot(aes(x = junction, y = n_spliced_reads,fill = disease)) +
geom_boxplot() +
labs(
title = "Annotated STMN2 event has higher expression in the control samples",
y = "Number of spliced reads"
)
spliced_reads_pdtp_stmn2 |>
ggplot(aes(x = disease, y = n_spliced_reads)) +
geom_boxplot() +
labs(
title = "Annotated STMN2 event has higher expression in the control samples",
y = "Number of spliced reads"
) + facet_wrap(~junction)
spliced_reads_pdtp_stmn2 |>
ggplot(aes(x = disease, y = n_spliced_reads, fill = disease)) +
geom_boxplot() +
labs(
title = "Annotated STMN2 event has higher expression in the control samples",
y = "Number of spliced reads"
)
spliced_reads_pdtp_stmn2 |>
ggplot(aes(x = junction, y = n_spliced_reads, fill = disease)) +
geom_boxplot() +
labs(
title = "Annotated STMN2 event has higher expression in the control samples",
y = "Number of spliced reads"
)
spliced_reads_pdtp_stmn2 |>
drop_na() |>
ggplot(aes(x = junction, y = n_spliced_reads, fill = pTDP_category)) +
geom_boxplot() +
labs(
title = "Higher expression of annotated STMN2 event with low levels of pTDP",
x = "Level of phosphorylated TDP-43",
y = "Number of spliced reads"
)
spliced_reads_pdtp_stmn2 |>
drop_na() |>
ggplot(aes(x = junction, y = n_spliced_reads, fill = pTDP_category)) +
geom_boxplot() +
labs(
title = "Higher expression of annotated STMN2 event with low levels of pTDP",
x = "Junction",
y = "Number of spliced reads"
)
spliced_reads_pdtp_stmn2 |>
drop_na() |>
ggplot(aes(x = MN_death, y = n_spliced_reads, color = junction)) +
geom_point() +
labs(
x = "Motor neuron death (%)",
y = "Number of spliced reads",
color = "Junction"
)
View(spliced_reads_pdtp_select)
View(spliced_reads_pdtp_stmn2)
View(mean_per_junction)
spliced_reads_pdtp_stmn2 |>
pivot_wider(names_from = 'junction',
values_from = 'n_spliced_reads')
View(mean_per_junction_sig)
mean_per_junction |>
semi_join(significant_junctions, by=("junction_name")) |>
mutate(higher_value = ifelse(ALS>control,"ALS","control")) |>
separate(junction_name, sep = '\\|',into = c("gene","junc_cat","n_datasets_junction_found"),convert = TRUE) |>
janitor::tabyl(junc_cat,higher_value)
mean_per_junction |>
semi_join(significant_junctions, by=("junction_name")) |>
mutate(higher_value = ifelse(ALS>control,"ALS","control")) |> group_by(higher_value) |>
separate(junction_name, sep = '\\|',into = c("gene","junc_cat","n_datasets_junction_found"),convert = TRUE) |>
summarize(mean_n_datasets = mean(n_datasets_junction_found))
?summarize()
spliced_reads_pdtp_stmn2 |>
pivot_wider(names_from = 'junction',
values_from = 'n_spliced_reads')
psi_stmn2 <- spliced_reads_pdtp_stmn2 |>
pivot_wider(names_from = 'junction',
values_from = 'n_spliced_reads')
View(psi_stmn2)
psi_stmn2 |>
group_by(sample_name) |>
mutate(psi =
cryptic/(annotated+cryptic))
psi_stmn2 |>
group_by(sample_name) |>
mutate(total_counts = annotated + cryptic)
psi_stmn2 <- spliced_reads_pdtp_stmn2 |>
select(-start,-end) |>
unique() |>
pivot_wider(names_from = 'junction',
values_from = 'n_spliced_reads',
values_fill = 0)
psi_stmn2 |>
group_by(sample_name) |>
mutate(total_counts = annotated + cryptic)
psi_stmn2 |>
group_by(sample_name) |>
mutate(total_counts = annotated + cryptic) |>
mutate(psi = cryptic / total_counts)
spliced_reads_pdtp_stmn2 |>
select(-start,-end)
spliced_reads_pdtp_stmn2
spliced_reads_pdtp_stmn2 |>
select(-start,-end)
spliced_reads_pdtp_stmn2 |>
select(-start,-end) |>
unique()
spliced_reads_pdtp_stmn2 |>
select(start,end)
spliced_reads_pdtp_stmn2 |>
unique() |>
pivot_wider(names_from = 'junction',
values_from = 'n_spliced_reads',
values_fill = 0)
spliced_reads_pdtp_stmn2 |>
select(-start,-end) |>
unique() |>
pivot_wider(names_from = 'junction',
values_from = 'n_spliced_reads',
values_fill = 0)
spliced_reads_pdtp_stmn2 |>
unique() |>
pivot_wider(names_from = 'junction',
values_from = 'n_spliced_reads',
values_fill = 0)
psi_stmn2 <- spliced_reads_pdtp_stmn2 |>
select(-start,-end) |>
unique() |>
pivot_wider(names_from = 'junction',
values_from = 'n_spliced_reads',
values_fill = 0)
psi_stmn2 |>
group_by(sample_name) |>
mutate(total_counts = annotated + cryptic) |>
mutate(psi = cryptic / total_counts)
psi_stmn2 <- psi_stmn2 |>
group_by(sample_name) |>
mutate(total_counts = annotated + cryptic) |>
mutate(psi = cryptic / total_counts)
psi_stmn2 |>
ggplot(aes(x = junction, y = psi, fill = disease)) +
geom_boxplot()
psi_stmn2 |>
ggplot(aes(x = pTDP_category, y = psi))
psi_stmn2 |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = psi)) +
geom_boxplot()
psi_stmn2 |>
drop_na() |>
ggplot(aes(x = disease, y = psi, fill = pTDP_category)) +
geom_boxplot()
psi_stmn2 |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = psi, fill = pTDP_category)) +
geom_boxplot()
psi_stmn2 |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = psi, fill = pTDP_category)) +
geom_boxplot() +
theme(legend.position = "none")
psi_stmn2 |>
drop_na() |>
ggplot(aes(x = MN_death, y = psi)) +
geom_point()
psi_stmn2 |>
drop_na() |>
ggplot(aes(x = MN_death, y = psi, fill = pTDP_category)) +
geom_point()
psi_stmn2 |>
drop_na() |>
ggplot(aes(x = MN_death, y = psi, color = pTDP_category)) +
geom_point()
psi_stmn2 |>
drop_na() |>
ggplot(aes(x = pTDP_category, y = psi, fill = pTDP_category)) +
geom_boxplot() +
theme(legend.position = "none") +
labs(
title = "STMN2 cryptic splicing is higher with low levels of pTDP",
x = "pTDP-43 accumulation",
y = "PSI value"
)
psi_stmn2 |>
drop_na() |>
ggplot(aes(x = MN_death, y = psi, color = pTDP_category)) +
geom_point()
psi_stmn2 |>
drop_na() |>
ggplot(aes(x = MN_death, y = psi, color = pTDP_category)) +
geom_point() +
labs(
x = "Motor neuron death (%)",
y = "PSI value"
)
psi_stmn2 |>
drop_na() |>
ggplot(aes(x = MN_death, y = psi, color = pTDP_category)) +
geom_point() +
labs(
x = "Motor neuron death (%)",
y = "PSI value",
color = "pTDP-43 accumulation"
)
psi_stmn2 |>
drop_na() |>
ggplot(aes(x = MN_death, y = psi, color = pTDP_category)) +
geom_point() +
labs(
x = "Motor neuron death (%)",
y = "PSI value",
color = "pTDP-43 \naccumulation"
)
psi_stmn2 |>
drop_na() |>
ggplot(aes(x = MN_death, y = psi, color = pTDP_category)) +
geom_point() +
labs(
x = "Motor neuron death (%)",
y = "PSI value",
color = "pTDP-43\naccumulation"
)
